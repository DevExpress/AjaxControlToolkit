// (c) 2010 CodePlex Foundation
(function(){var b="ExtendedPagedList";function a(){var c="indexChanged",b=";",a=null;Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.PagingBulletedListBehavior=function(c){var b=this;Sys.Extended.UI.PagingBulletedListBehavior.initializeBase(b,[c]);b._indexSizeValue=1;b._separatorValue=" - ";b._heightValue=a;b._maxItemPerPage=a;b._clientSortValue=false;b._selectIndexCssClassValue=a;b._unselectIndexCssClassValue=a;b._tabValue=[];b._tabValueObject=[];b._tabIndex=[];b._divContent=a;b._divContentIndex=a;b._divContentUl=a;b._prevIndexSelected=a;b._indexSelected=0;b._clickIndex=a};Sys.Extended.UI.PagingBulletedListBehavior.prototype={initialize:function(){var c=this;Sys.Extended.UI.PagingBulletedListBehavior.callBaseMethod(c,"initialize");var i=c.get_ClientState();if(i){var f=i.split(b);if(f.length){c._indexSelected=f[0];if(f[1]=="null")c._indexSizeValue=a;else c._indexSizeValue=f[1];if(f[2]=="null")c._maxItemPerPage=a;else c._maxItemPerPage=f[2];if(f[3]=="true")c._clientSortValue=true;else c._clientSortValue=false}}var g=c.get_element();c._divContent=document.createElement("div");g.parentNode.insertBefore(c._divContent,g);var e=g.childNodes;c._clickIndex=Function.createDelegate(c,c._onIndexClick);var h,j;c._divContentIndex=document.createElement("DIV");c._divContentIndex.style.marginBottom="5px";c._divContent.appendChild(c._divContentIndex);for(var d=0;d<e.length;d++)if(e[d].nodeName=="LI"){if(e[d].firstChild&&e[d].firstChild.innerHTML)h=e[d].firstChild.innerHTML;else h=e[d].innerHTML;c._tabValueObject[c._tabValueObject.length]={text:h,obj:e[d],index:d}}c._clientSortValue&&c._tabValueObject.sort(c.liElementSortText);c._generateIndexAndTabForView();c._removeChilds(g.childNodes);c._divContentUl=document.createElement("DIV");c._changeHeightDivContent();c._divContentUl.appendChild(g);c._divContent.appendChild(c._divContentUl);c._updateIndexAndView(c._indexSelected)},_changeHeightDivContent:function(){var a=this;if(a._heightValue){a._divContentUl.style.overflow="scroll";a._divContentUl.style.height=a._heightValue+"px"}else{a._divContentUl.style.overflow="";a._divContentUl.style.height=""}},_createAHrefIndex:function(e,d){var b=this,c,a;a=document.createElement("a");a.href="";b._unselectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(a,b._unselectIndexCssClassValue);a.innerHTML=e;a.tag=d;$addHandler(a,"click",b._clickIndex);b._tabIndex[b._tabIndex.length]=a;b._divContentIndex.appendChild(a);c=document.createElement("SPAN");c.innerHTML="﻿"+b._separatorValue+"﻿";b._divContentIndex.appendChild(c);return c},liElementSortText:function(a,b){return a.text.toLowerCase()==b.text.toLowerCase()?0:a.text.toLowerCase()<b.text.toLowerCase()?-1:1},liElementSortIndex:function(a,b){return a.index-b.index},_generateIndexAndTabForView:function(){var a=this;a._deleteTabIndexAndTabValue();a._tabValue=[];a._tabIndex=[];var d;a._removeChilds(a._divContentIndex.childNodes);if(a._maxItemPerPage){if(a._maxItemPerPage>0)for(var b=-1,c=0;c<a._tabValueObject.length;c++){if(c%a._maxItemPerPage==0){b++;index=a._tabValueObject[c].text;a._tabValue[b]=[];d=a._createAHrefIndex(index,b)}a._tabValue[b][a._tabValue[b].length]=a._tabValueObject[c].obj}}else if(a._indexSizeValue>0)for(var e="",b=-1,c=0;c<a._tabValueObject.length;c++){index=a._tabValueObject[c].text.substr(0,a._indexSizeValue).toUpperCase();if(e!=index){b++;a._tabValue[b]=[];d=a._createAHrefIndex(index,b);e=index}a._tabValue[b][a._tabValue[b].length]=a._tabValueObject[c].obj}d&&a._divContentIndex.removeChild(d)},_deleteTabIndexAndTabValue:function(){var b=this;if(b._clickIndex){for(var c=0;c<b._tabIndex.length;c++){var d=b._tabIndex[c];d&&$removeHandler(d,"click",b._clickIndex)}b._changeHandler=a}delete b._tabIndex;for(var c=0;c<b._tabValue.length;c++)delete b._tabValue[c];delete b._tabValue},dispose:function(){this._deleteTabIndexAndTabValue();delete this._tabValueObject;Sys.Extended.UI.PagingBulletedListBehavior.callBaseMethod(this,"dispose")},_removeChilds:function(a){for(var b=0;a.length;b++)a[0].parentNode.removeChild(a[0])},_renderHtml:function(c){var a=this,d=a.get_element();a._removeChilds(d.childNodes);for(var b=0;b<a._tabValue[c].length;b++)d.appendChild(a._tabValue[c][b]);a._divContentUl.scrollTop=0},_selectIndex:function(b){var a=this;if(a._tabIndex.length>0){a._unselectIndexCssClassValue&&Sys.UI.DomElement.removeCssClass(a._tabIndex[b],a._unselectIndexCssClassValue);a._selectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(a._tabIndex[b],a._selectIndexCssClassValue);a._prevIndexSelected=a._tabIndex[b];a.raiseIndexChanged(a._tabIndex[b])}},_onIndexClick:function(c){var a=this,d=a.get_element(),b=c.target;a._selectIndexCssClassValue&&Sys.UI.DomElement.removeCssClass(a._prevIndexSelected,a._selectIndexCssClassValue);a._unselectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(a._prevIndexSelected,a._unselectIndexCssClassValue);a._unselectIndexCssClassValue&&Sys.UI.DomElement.removeCssClass(b,a._unselectIndexCssClassValue);a._selectIndexCssClassValue&&Sys.UI.DomElement.addCssClass(b,a._selectIndexCssClassValue);a._prevIndexSelected=b;a._renderHtml(b.tag);a.raiseIndexChanged(b);c.preventDefault()},add_indexChanged:function(a){this.get_events().addHandler(c,a)},remove_indexChanged:function(a){this.get_events().removeHandler(c,a)},raiseIndexChanged:function(d){var a=this;a._indexSelected=d.tag;var e=a.get_events().getHandler(c);if(e){if(!d)d=Sys.EventArgs.Empty;e(a,d)}a.set_ClientState(d.tag+b+a.get_IndexSize()+b+a.get_MaxItemPerPage()+b+a.get_ClientSort())},get_tabIndex:function(){return this._tabIndex},get_tabValue:function(){return this._tabValue},_updateIndexAndView:function(b){var a=this;a._generateIndexAndTabForView();if(a._tabIndex.length>0)if(b<a._tabIndex.length){a._renderHtml(a._tabIndex[b].tag);a._selectIndex(b)}else{a._renderHtml(a._tabIndex[0].tag);a._selectIndex(0)}},get_Height:function(){return this._heightValue},set_Height:function(b){var a=this;if(a._heightValue!=b){a._heightValue=b;a.get_isInitialized()&&a._changeHeightDivContent();a.raisePropertyChanged("Height")}},get_IndexSize:function(){return this._indexSizeValue},set_IndexSize:function(c){var a=this;if(a._indexSizeValue!=c){a.set_ClientState("0;"+c+b+a.get_MaxItemPerPage()+b+a.get_ClientSort());a._indexSizeValue=c;a.get_isInitialized()&&a._updateIndexAndView(0);a.raisePropertyChanged("IndexSize")}},get_MaxItemPerPage:function(){return this._maxItemPerPage},set_MaxItemPerPage:function(c){var a=this;if(a._maxItemPerPage!=c){a.set_ClientState("0;"+a.get_IndexSize()+b+c+b+a.get_ClientSort());a._maxItemPerPage=c;a.get_isInitialized()&&a._updateIndexAndView(0);a.raisePropertyChanged("MaxItemPerPage")}},get_Separator:function(){return this._separatorValue},set_Separator:function(b){var a=this;if(a._separatorValue!=b){if(b)a._separatorValue=b;else a._separatorValue="";a.get_isInitialized()&&a._updateIndexAndView(0);a.raisePropertyChanged("Separator")}},get_ClientSort:function(){return this._clientSortValue},set_ClientSort:function(c){var a=this;if(a._clientSortValue!=c){a.set_ClientState("0;"+a.get_IndexSize()+b+a.get_MaxItemPerPage()+b+c);a._clientSortValue=c;if(a.get_isInitialized()){if(a._clientSortValue)a._tabValueObject.sort(a.liElementSortText);else a._tabValueObject.sort(a.liElementSortIndex);a._updateIndexAndView(0)}a.raisePropertyChanged("ClientSort")}},get_SelectIndexCssClass:function(){return this._selectIndexCssClassValue},set_SelectIndexCssClass:function(a){if(this._selectIndexCssClassValue!=a){this._selectIndexCssClassValue=a;this.raisePropertyChanged("SelectIndexCssClass")}},get_UnselectIndexCssClass:function(){return this._unselectIndexCssClassValue},set_UnselectIndexCssClass:function(a){if(this._unselectIndexCssClassValue!=a){this._unselectIndexCssClassValue=a;this.raisePropertyChanged("UnselectIndexCssClass")}}};Sys.Extended.UI.PagingBulletedListBehavior.registerClass("Sys.Extended.UI.PagingBulletedListBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.PagingBulletedListBehavior,{name:"pagedList"})}if(window.Sys&&Sys.loader)Sys.loader.registerScript(b,["ExtendedBase"],a);else a()})();