Type.registerNamespace("Sys.Extended.UI.HTMLEditor.ToolbarButton");Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles=function(a){Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.initializeBase(this,[a])};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.prototype={callMethod:function(){var b=false;if(!Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.callBaseMethod(this,"callMethod"))return b;var a=this._designPanel;setTimeout(function(){var s="function",w="size",v="face",u="color",t="class",l="_right_",k="_left_",h=true,c=null,d="",O=!Sys.Extended.UI.HTMLEditor.isIE?Sys.Extended.UI.HTMLEditor.Trim(a.getSelectedHTML()):d,q=a._getSelection(),o=a._createRange(q),f=c,J=b;if(!a.isControl()&&(Sys.Extended.UI.HTMLEditor.isIE&&o.text.length>0||!Sys.Extended.UI.HTMLEditor.isIE&&O.length>0))f=a._getTextNodeCollection();else{f=a._tryExpand();J=h}if(f!=c&&f.length>0){var K=b,C=h,R=c;a._saveContent();var m=a._doc.createElement("span");m.id=k;var j=a._doc.createElement("span");j.id=l;var P=f[0].parentNode,N=f[f.length-1].parentNode;P.insertBefore(m,f[0]);if(f[f.length-1].nextSibling)N.insertBefore(j,f[f.length-1].nextSibling);else N.appendChild(j);while(C){C=b;for(var n=0;n<f.length;n++){var g=f[n].parentNode;if(g)if(f[n].previousSibling==c&&f[n].nextSibling==c){var z=g.tagName.toUpperCase();if(Sys.Extended.UI.HTMLEditor.isStyleTag(z)&&z!="A"&&(g.className!=Sys.Extended.UI.HTMLEditor.smartClassName||z.substr(0,1)=="H")){var D=Sys.Extended.UI.HTMLEditor.differAttr(g,[t,u,v,w]);K=h;if(D.length==0){var x=g.parentNode,r=g.firstChild?g.firstChild:c,F=c;if(z.toUpperCase().substr(0,1)=="H"&&Sys.Extended.UI.HTMLEditor.isIE){F=a._doc.createElement("p");F.className=Sys.Extended.UI.HTMLEditor.smartClassName;x.insertBefore(F,g);while(g.firstChild)F.appendChild(g.firstChild)}else{while(g.firstChild)x.insertBefore(g.firstChild,g);if(z.toUpperCase().substr(0,1)=="H"){var Q=a._doc.createElement("br");x.insertBefore(Q,g)}}x.removeChild(g);C=h}else{for(var x=g.parentNode,I=a._doc.createElement(z),E=0;E<D.length;E++)I.setAttribute(D[E][0],D[E][1]);x.insertBefore(I,g);while(g.firstChild)I.appendChild(g.firstChild);x.removeChild(g)}}}}}for(var n=0;n<f.length;n++){var r=f[n],i=f[n].parentNode!=c&&typeof f[n].parentNode!="undefined"?f[n].parentNode:c;if(i){var p=c;while(i&&i.tagName&&i.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HTMLEditor.isStyleTag(i.tagName)&&i.tagName.toUpperCase()!="A"&&Sys.Extended.UI.HTMLEditor.differAttr(i,[t,u,v,w]).length==0){p=i;i=i.parentNode}if(p){K=h;function H(f,e,g,h){var a=g.cloneNode(b);if(f)if(f.push&&typeof f.push==s)for(var j=0;j<f.length;j++)a.appendChild(f[j]);else a.appendChild(f);while(e){var q=h?e.previousSibling:e.nextSibling;if(e.nodeType==1||e.nodeType==3&&Sys.Extended.UI.HTMLEditor.Trim(d+e.data+d).length>0){if(e.nodeType==1){Sys.Extended.UI.HTMLEditor.isStyleTag(e.tagName)&&e.tagName.toUpperCase()!="A"&&(!e.id||e.id!=k&&e.id!=l)&&Sys.Extended.UI.HTMLEditor.spanJoiner(e);if(Sys.Extended.UI.HTMLEditor.isStyleTag(e.tagName)&&e.childNodes.length==0&&(!e.id||e.id!=k&&e.id!=l))e=c}if(e)if(a.childNodes.length==0||!h)a.appendChild(e);else a.insertBefore(e,a.firstChild)}e=q}if(a.childNodes.length==0){delete a;a=c}else if(a.childNodes.length==1&&a.firstChild.nodeType==3&&(d+a.firstChild.data+d).length==0){delete a;a=c}else if(Sys.Extended.UI.HTMLEditor.isStyleTag(a.tagName)){for(var n=a.childNodes.length,i=0;i<a.childNodes.length;i++){var m=a.childNodes.item(i);if(m.nodeType==1&&!Sys.Extended.UI.HTMLEditor.isStyleTag(m.tagName))n--}if(n==0){var o=[];while(a.firstChild){var m=a.removeChild(a.firstChild);o.push(m)}a=o}}return g==p?a:H(a,h?g.previousSibling:g.nextSibling,g.parentNode,h)}i=r.parentNode;if(r.previousSibling==c&&r.nextSibling==c&&i&&i.tagName&&i.tagName.toUpperCase()!="BODY"&&Sys.Extended.UI.HTMLEditor.isStyleTag(i.tagName)&&Sys.Extended.UI.HTMLEditor.differAttr(i,[t,u,v,w]).length>0)r=i;var A=H(c,r.previousSibling,r.parentNode,h),B=H(c,r.nextSibling,r.parentNode,b),g=p.parentNode;if(A){if(A.push&&typeof A.push==s)for(var y=0;y<A.length;y++)g.insertBefore(A[y],p);else g.insertBefore(A,p);if(Sys.Extended.UI.HTMLEditor.isIE){m=a._doc.getElementById(k);j=a._doc.getElementById(l)}}g.insertBefore(r,p);if(B){if(B.push&&typeof B.push==s)for(var y=0;y<B.length;y++)g.insertBefore(B[y],p);else g.insertBefore(B,p);if(Sys.Extended.UI.HTMLEditor.isIE){m=a._doc.getElementById(k);j=a._doc.getElementById(l)}}g.removeChild(p)}}}if(J){if(Sys.Extended.UI.HTMLEditor.isIE&&a.__saveBM__!=c){try{var e=m.parentNode;e.removeChild(m);while(e&&e.childNodes.length==0){e.parentNode.removeChild(e);e=e.parentNode}e=j.parentNode;e.removeChild(j);while(e&&e.childNodes.length==0){e.parentNode.removeChild(e);e=e.parentNode}m=c;j=c}catch(S){}var q=a._getSelection(),o=a._createRange(q);o.moveToBookmark(a.__saveBM__);o.select();a.__saveBM__=c}else if(a.__saveBM__!=c){if(a.__saveBM__[0].nodeType==3){var q=a._getSelection(),o=a._doc.createRange();o.setStart(a.__saveBM__[0],a.__saveBM__[1]);o.setEnd(a.__saveBM__[0],a.__saveBM__[1]);a._removeAllRanges(q);a._selectRange(q,o)}else{a._trySelect(a.__saveBM__[0],a.__saveBM__[0]);a.__saveBM__[0].parentNode.removeChild(a.__saveBM__[0])}a.__saveBM__=c}}else if(!Sys.Extended.UI.HTMLEditor.isIE){f=[];var C=b;function M(a,e){while(a){if(a==j){C=h;return}if(a.nodeType==3){while(a.nextSibling&&a.nextSibling.nodeType==3){a.data=d+a.data+d+a.nextSibling.data+d;a.parentNode.removeChild(a.nextSibling)}Sys.Extended.UI.HTMLEditor.Trim(d+a.data+d).length>0&&f.push(a)}else M(a.firstChild,b);if(C)return;var g=a.parentNode;if(e)while(a&&a.nextSibling==c)a=a.parentNode;a=a.nextSibling}}M(m,h);o=a._doc.createRange();o.setStart(f[0],0);o.setEnd(f[f.length-1],(d+f[f.length-1].data+d).length);a._removeAllRanges(q);a._selectRange(q,o)}else try{q=a._getSelection();var G=a._createRange(q),L=a._createRange(q);G.moveToElementText(m);L.moveToElementText(j);G.setEndPoint("EndToEnd",L);G.select()}catch(S){}try{var e;if(m!=c){e=m.parentNode;e.removeChild(m);while(e&&e.childNodes.length==0){e.parentNode.removeChild(e);e=e.parentNode}}if(j!=c){e=j.parentNode;e.removeChild(j);while(e&&e.childNodes.length==0){e.parentNode.removeChild(e);e=e.parentNode}}}catch(S){}a.onContentChanged();a._editPanel.updateToolbar()}},0)}};Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles.registerClass("Sys.Extended.UI.HTMLEditor.ToolbarButton.RemoveStyles",Sys.Extended.UI.HTMLEditor.ToolbarButton.MethodButton);