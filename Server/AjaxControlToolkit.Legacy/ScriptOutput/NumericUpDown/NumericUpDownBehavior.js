// (c) 2010 CodePlex Foundation
(function(){var b="ExtendedUpDown";function a(){var e="currentChanged",d="click",b=false,c=true,a=null;Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.NumericUpDownBehavior=function(c){var b=this;Sys.Extended.UI.NumericUpDownBehavior.initializeBase(b,[c]);b._currentValue=a;b._widthValue=a;b._targetButtonUpIDValue=a;b._targetButtonDownIDValue=a;b._serviceUpPathValue=location.pathname;b._serviceUpMethodValue=a;b._serviceDownPathValue=location.pathname;b._serviceDownMethodValue=a;b._refValuesValue=a;b._tagValue=a;b._elementTextBox=a;b._step=1;b._min=-Number.MAX_VALUE;b._max=Number.MAX_VALUE;b._bUp=a;b._bDown=a;b._stepPrecision=0;b._valuePrecision=0;b._clickUpHandler=a;b._clickDownHandler=a;b._changeHandler=a};Sys.Extended.UI.NumericUpDownBehavior.prototype={initialize:function(){var p="Tahoma, Arial, sans-serif",o="Webdings",n="outset 1px",f="0",j="middle",i="24px",m="relative",h="px",e=this;Sys.Extended.UI.NumericUpDownBehavior.callBaseMethod(e,"initialize");$common.prepareHiddenElementForATDeviceUpdate();var g=e.get_element();e._elementTextBox=g;if(e._refValuesValue||e._serviceUpMethodValue||e._serviceDownMethodValue)e._elementTextBox.readOnly=c;else e._elementTextBox.readOnly=b;e.readValue();e._changeHandler=Function.createDelegate(e,e._onChange);$addHandler(g,"blur",e._changeHandler);if(!e._targetButtonUpIDValue||!e._targetButtonDownIDValue){e._widthValue=Math.max(e._widthValue,24);g.style.width=e._widthValue-24+h;g.style.textAlign="center";var k=document.createElement("DIV");k.style.position=m;k.style.width=e._widthValue+h;k.style.fontSize=g.clientHeight+h;k.style.height=g.clientHeight+h;k.style.paddingRight=i;if(!(Sys.Browser.agent==Sys.Browser.Firefox||Sys.Browser.agent==Sys.Browser.Safari))k.style.display="inline";else k.style.display="inline-block";g.parentNode.insertBefore(k,g);var l=document.createElement("TABLE"),t=document.createElement("TBODY"),u=document.createElement("TR"),v=document.createElement("TR"),q=document.createElement("TD"),s=document.createElement("TD"),r=document.createElement("TD");q.rowSpan="2";q.style.verticalAlign=j;s.style.verticalAlign=j;r.style.verticalAlign=j;u.appendChild(q);u.appendChild(s);v.appendChild(r);t.appendChild(u);t.appendChild(v);l.appendChild(t);k.appendChild(l);g.parentNode.removeChild(g);q.appendChild(g);l.style.borderCollapse="collapse";l.cellSpacing=f;l.cellPadding=f;l.style.display="inline";l.style.position=m;q.style.padding=f;s.style.padding=f;r.style.padding=f;q.style.margin=f;s.style.margin=f;r.style.margin=f}if(!e._targetButtonUpIDValue){e._bUp=document.createElement("input");e._bUp.type="button";e._bUp.id=g.id+"_bUp";e._bUp.style.border=n;if(Sys.Browser.agent==Sys.Browser.InternetExplorer){e._bUp.style.fontFamily=o;e._bUp.style.fontSize="9pt";e._bUp.value="5"}else{e._bUp.style.fontFamily=p;e._bUp.style.fontSize="5pt";e._bUp.value="▲";e._bUp.style.fontWeight="bold";e._bUp.style.lineHeight="3pt"}e._bUp.style.height="12px";e._bUp.style.width=i;e._bUp.style.overflow="hidden";e._bUp.style.lineHeight="1em";s.appendChild(e._bUp)}if(!e._targetButtonDownIDValue){e._bDown=document.createElement("input");e._bDown.type="button";e._bDown.id=g.id+"_bDown";e._bDown.style.border=n;if(Sys.Browser.agent==Sys.Browser.InternetExplorer){e._bDown.value="6";e._bDown.style.fontFamily=o;e._bDown.style.fontSize="9pt"}else{e._bDown.value="▼";e._bDown.style.fontFamily=p;e._bDown.style.fontSize="5pt";e._bDown.style.fontWeight="bold"}e._bDown.style.height="12px";e._bDown.style.lineHeight="3pt";e._bDown.style.width=i;e._bDown.style.overflow="hidden";r.appendChild(e._bDown)}if(e._bUp==a)e._bUp=document.getElementById(e._targetButtonUpIDValue);if(e._bUp){e._clickUpHandler=Function.createDelegate(e,e._clickUp);$addHandler(e._bUp,d,e._clickUpHandler)}if(e._bDown==a)e._bDown=document.getElementById(e._targetButtonDownIDValue);if(e._bDown){e._clickDownHandler=Function.createDelegate(e,e._clickDown);$addHandler(e._bDown,d,e._clickDownHandler)}},dispose:function(){var b=this;if(b._changeHandler){$removeHandler(b.get_element(),"blur",b._changeHandler);b._changeHandler=a}if(b._clickUpHandler)if(b._bUp){$removeHandler(b._bUp,d,b._clickUpHandler);b._clickUpHandler=a}if(b._clickDownHandler)if(b._bDown){$removeHandler(b._bDown,d,b._clickDownHandler);b._clickDownHandler=a}Sys.Extended.UI.NumericUpDownBehavior.callBaseMethod(b,"dispose")},add_currentChanged:function(a){this.get_events().addHandler(e,a)},remove_currentChanged:function(a){this.get_events().removeHandler(e,a)},raiseCurrentChanged:function(a){var b=this.get_events().getHandler(e);if(b){if(!a)a=Sys.EventArgs.Empty;b(this,a)}},_onChange:function(){var a=this;a.readValue();if(a._refValuesValue){a.setCurrentToTextBox(a._refValuesValue[a._currentValue]);if(a._elementTextBox)a._elementTextBox.readOnly=c}else{a.setCurrentToTextBox(a._currentValue);if(a._elementTextBox)a._elementTextBox.readOnly=a._serviceUpMethodValue||a._serviceDownMethodValue}},readValue:function(){var a=this;if(a._elementTextBox){var c=a._elementTextBox.value;if(!a._refValuesValue){if(!c)a._currentValue=a._min;else try{a._currentValue=parseFloat(c)}catch(e){a._currentValue=a._min}if(isNaN(a._currentValue))a._currentValue=a._min;a.setCurrentToTextBox(a._currentValue);a._valuePrecision=a._computePrecision(a._currentValue)}else{if(!c)a._currentValue=0;else{for(var d=0,b=0;b<a._refValuesValue.length;b++)if(c.toLowerCase()==a._refValuesValue[b].toLowerCase())d=b;a._currentValue=d}a.setCurrentToTextBox(a._refValuesValue[a._currentValue])}}},setCurrentToTextBox:function(e){var a=this;if(a._elementTextBox){a._elementTextBox.value=e;a.raiseCurrentChanged(e);if(document.createEvent){var d=document.createEvent("HTMLEvents");d.initEvent("change",c,b);a._elementTextBox.dispatchEvent(d)}else document.createEventObject&&a._elementTextBox.fireEvent("onchange")}},_incrementValue:function(b){var a=this,c=parseFloat((a._currentValue+b).toFixed(Math.max(a._stepPrecision,a._valuePrecision)));if(b>0)a._currentValue=Math.max(Math.min(c,a._max),a._min);else a._currentValue=Math.min(Math.max(c,a._min),a._max)},_computePrecision:function(b){if(b==Number.Nan)return this._min;var c=b.toString();if(c){var d=/\.(\d*)$/,a=c.match(d);if(a&&a.length==2&&a[1])return a[1].length}return this._min},get_Width:function(){return this._widthValue},set_Width:function(a){if(this._widthValue!=a){this._widthValue=a;this.raisePropertyChanged("Width")}},get_Tag:function(){return this._tagValue},set_Tag:function(a){if(this._tagValue!=a){this._tagValue=a;this.raisePropertyChanged("Tag")}},get_TargetButtonUpID:function(){return this._targetButtonUpIDValue},set_TargetButtonUpID:function(a){if(this._targetButtonUpIDValue!=a){this._targetButtonUpIDValue=a;this.raisePropertyChanged("TargetButtonUpID")}},get_TargetButtonDownID:function(){return this._targetButtonDownIDValue},set_TargetButtonDownID:function(a){if(this._targetButtonDownIDValue!=a){this._targetButtonDownIDValue=a;this.raisePropertyChanged("TargetButtonDownID")}},get_ServiceUpPath:function(){return this._serviceUpPathValue},set_ServiceUpPath:function(a){if(this._serviceUpPathValue!=a){this._serviceUpPathValue=a;this.raisePropertyChanged("ServiceUpPath")}},get_ServiceUpMethod:function(){return this._serviceUpMethodValue},set_ServiceUpMethod:function(b){var a=this;if(a._serviceUpMethodValue!=b){a._serviceUpMethodValue=b;a.raisePropertyChanged("ServiceUpMethod");if(a._elementTextBox)a._elementTextBox.readOnly=c}},get_ServiceDownPath:function(){return this._serviceDownPathValue},set_ServiceDownPath:function(a){if(this._serviceDownPathValue!=a){this._serviceDownPathValue=a;this.raisePropertyChanged("ServiceDownPath")}},get_ServiceDownMethod:function(){return this._serviceDownMethodValue},set_ServiceDownMethod:function(b){var a=this;if(a._serviceDownMethodValue!=b){a._serviceDownMethodValue=b;a.raisePropertyChanged("ServiceDownMethod");if(a._elementTextBox)a._elementTextBox.readOnly=c}},get_RefValues:function(){return this._refValuesValue?this._refValuesValue.join(";"):""},set_RefValues:function(e){var d=this;if(e!=""){d._refValuesValue=e.split(";");d._onChange();if(d._elementTextBox)d._elementTextBox.readOnly=c}else{d._refValuesValue=a;if(d._elementTextBox)d._elementTextBox.readOnly=b}d.raisePropertyChanged("RefValues")},get_Step:function(){return this._step},set_Step:function(b){var a=this;if(b!=a._step){a._step=b;a._stepPrecision=a._computePrecision(b);a.raisePropertyChanged("Step")}},get_Minimum:function(){return this._min},set_Minimum:function(a){if(a!=this._min){this._min=a;this.raisePropertyChanged("Minimum")}},get_Maximum:function(){return this._max},set_Maximum:function(a){if(a!=this._max){this._max=a;this.raisePropertyChanged("Maximum")}},_clickUp:function(c){var a=this;a.readValue();if(a._serviceUpPathValue&&a._serviceUpMethodValue){Sys.Net.WebServiceProxy.invoke(a._serviceUpPathValue,a._serviceUpMethodValue,b,{current:a._currentValue,tag:a._tagValue},Function.createDelegate(a,a._onMethodUpDownComplete));$common.updateFormToRefreshATDeviceBuffer()}else if(a._refValuesValue){if(a._currentValue+1<a._refValuesValue.length){a._currentValue=a._currentValue+1;a.setCurrentToTextBox(a._refValuesValue[a._currentValue])}}else{a._incrementValue(a._step);a.setCurrentToTextBox(a._currentValue)}c&&c.preventDefault();return b},_clickDown:function(c){var a=this;a.readValue();if(a._serviceDownPathValue&&a._serviceDownMethodValue){Sys.Net.WebServiceProxy.invoke(a._serviceDownPathValue,a._serviceDownMethodValue,b,{current:a._currentValue,tag:a._tagValue},Function.createDelegate(a,a._onMethodUpDownComplete));$common.updateFormToRefreshATDeviceBuffer()}else if(a._refValuesValue){if(a._currentValue-1>=0){a._currentValue=a._currentValue-1;a.setCurrentToTextBox(a._refValuesValue[a._currentValue])}}else{a._incrementValue(-a._step);a.setCurrentToTextBox(a._currentValue)}c&&c.preventDefault();return b},_onMethodUpDownComplete:function(a){this._currentValue=a;this.setCurrentToTextBox(this._currentValue)}};Sys.Extended.UI.NumericUpDownBehavior.registerClass("Sys.Extended.UI.NumericUpDownBehavior",Sys.Extended.UI.BehaviorBase);Sys.registerComponent(Sys.Extended.UI.NumericUpDownBehavior,{name:"upDown",parameters:["Minimum","Maximum","Width"]})}if(window.Sys&&Sys.loader)Sys.loader.registerScript(b,["ExtendedCommon","ExtendedBase","WebServices"],a);else a()})();