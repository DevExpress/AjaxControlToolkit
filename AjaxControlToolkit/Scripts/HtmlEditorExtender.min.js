Type.registerNamespace("Sys.Extended.UI");Sys.Extended.UI.HtmlEditorExtenderBehavior=function(n){Sys.Extended.UI.HtmlEditorExtenderBehavior.initializeBase(this,[n]);this._textbox=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(n);var t=this.get_id();this._backColor=null;this._foreColor=null;this._commandName=null;this._savedRange=null;this._isInFocus=null;this._oldContents=null;this._newContents=null;this._isDirty=!1;this._viewMode="content";this._displaySourceTab=!1;this._ButtonWidth=23;this._ButtonHeight=21;this._containerTemplate={nodeName:"div",properties:{id:t+"_ExtenderContainer"},cssClasses:["unselectable","ajax__html_editor_extender_container"]};this._editableTemplate={nodeName:"div",properties:{id:t+"_ExtenderContentEditable",style:{overflow:"auto",clear:"both"},contentEditable:!0},cssClasses:["ajax__html_editor_extender_texteditor"]};this._sourceViewTemplate={nodeName:"div",properties:{id:t+"_ExtenderSourceView",style:{height:"90%",overflow:"auto",clear:"both"},contentEditable:!0},cssClasses:["ajax__html_editor_extender_texteditor"]};this._buttonTemplate={nodeName:"input",properties:{type:"button",style:{width:this._ButtonWidth+"px",height:this._ButtonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button"]};this._buttonContentTemplate={nodeName:"input",properties:{type:"button",style:{width:this._ButtonWidth+"px",height:this._ButtonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button ajax__html_editor_extender_content"]};this._buttonSourceTemplate={nodeName:"input",properties:{type:"button",style:{width:this._ButtonWidth+"px",height:this._ButtonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button ajax__html_editor_extender_source"]};this._textboxTemplate={nodeName:"input",properties:{type:"text"}};this._dropDownTemplate={nodeName:"select",properties:{style:{width:this._ButtonWidth+"px",height:this._ButtonHeight+"px"}},cssClasses:["ajax__html_editor_extender_button"]};this._topButtonContainerTemplate={nodeName:"div",properties:{id:t+"_ExtenderButtonContainer"},cssClasses:["ajax__html_editor_extender_buttoncontainer"]};this._topButtonContainerTemplate2={nodeName:"div",properties:{id:t+"_ExtenderButtonContainer2",style:{clear:"both"}},cssClasses:["ajax__html_editor_extender_buttoncontainer2"]};this._container=null;this._toolbarButtons=null;this._editableDiv=null;this._sourceViewDiv=null;this._topButtonContainer=null;this._topButtonContainer2=null;this._buttons=[];this._requested_buttons=[];this._colorPicker=null;this._txtBoxForColor=null;this._contentViewButton=null;this._sourceViewButton=null;this._popupDiv=null;this._btnDone=null;this._btnCancel=null;this._isFocusInEditableDiv=!1;this._textBoxOnBlurDelegate=null;this._editableDivOnBlurDelegate=null;this._editableDivOnFocusDelegate=null;this._btnClickDelegate=null;this._contentViewClickDelegate=null;this._sourceViewClickDelegate=null;this._sourceViewDivOnBlurDelegate=null;this._imageCancelClickDelegate=null;typeof WebForm_OnSubmit!="function"||Sys.Extended.UI.HtmlEditorExtenderBehavior._originalWebForm_OnSubmit||(Sys.Extended.UI.HtmlEditorExtenderBehavior._originalWebForm_OnSubmit=WebForm_OnSubmit,WebForm_OnSubmit=Sys.Extended.UI.HtmlEditorExtenderBehavior.WebForm_OnSubmit)};Sys.Extended.UI.HtmlEditorExtenderBehavior.prototype={initialize:function(){var t,n;for(Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(this,"initialize"),HtmlEditorExtender_editableDivs[HtmlEditorExtender_editableDivs.length]=this,this._button_list=[],this._createContainer(),this._createTopButtonContainer(),this._createButton(),this._createEditableDiv(),this.get_displaySourceTab()&&(this._createSourceViewDiv(),this._createTopButtonContainer2()),t=this._textbox._element.parentNode;t!=null&&t.nodeName!="FORM";)t=t.parentNode;if(t==null)throw"Missing Form tag";n=this.get_id();this._popupDiv=$get(n+"_popupDiv");this._popupDiv==null&&(n=n.indexOf("_")!=-1?n.substring(n.lastIndexOf("_")+1):"",this._popupDiv=$get(n+"_popupDiv"));this._popupDiv!=null&&(this._popupBehavior=$create(Sys.Extended.UI.PopupBehavior,{id:n+"_ImagePopupBehavior",parentElement:this.get_element(),unselectable:"on"},null,null,this._popupDiv),this._btnCancel=$get(n+"_btnCancel"),this._imageCancelClickDelegate=Function.createDelegate(this,this._btnCancel_click),$addHandler(this._btnCancel,"click",this._imageCancelClickDelegate,!0),this._elementVisible(this._popupDiv,!1));this._textBoxOnBlurDelegate=Function.createDelegate(this,this._textBox_onblur);this._editableDivOnBlurDelegate=Function.createDelegate(this,this._editableDiv_onblur);this._editableDivOnFocusDelegate=Function.createDelegate(this,this._editableDiv_onfocus);this._btnClickDelegate=Function.createDelegate(this,this._executeCommand);this.get_displaySourceTab()&&(this._contentViewClickDelegate=Function.createDelegate(this,this._contentView_click),this._sourceViewClickDelegate=Function.createDelegate(this,this._sourceView_click),this._sourceViewDivOnBlurDelegate=Function.createDelegate(this,this._sourceViewDiv_onblur));$addHandler(this._textbox._element,"blur",this._textBoxOnBlurDelegate,!0);$addHandler(this._editableDiv,"blur",this._editableDivOnBlurDelegate,!0);$addHandler(this._editableDiv,"focus",this._editableDivOnFocusDelegate,!0);$addHandler(this._topButtonContainer,"click",this._btnClickDelegate,!0);this.get_displaySourceTab()&&($addHandler(this._contentViewButton,"click",this._contentViewClickDelegate,!0),$addHandler(this._sourceViewButton,"click",this._sourceViewClickDelegate,!0),$addHandler(this._sourceViewDiv,"blur",this._sourceViewDivOnBlurDelegate,!0))},_dispose:function(){$removeHandler(this._textbox._element,"blur",this._textBoxOnBlurDelegate);$removeHandler(this._editableDiv,"blur",this._editableDivOnBlurDelegate);$removeHandler(this._editableDiv,"focus",this._editableDivOnFocusDelegate);$removeHandler(this._topButtonContainer,"click",this._btnClickDelegate);this.get_displaySourceTab()&&($removeHandler(this._contentViewButton,"click",this._contentViewClickDelegate),$removeHandler(this._sourceViewButton,"click",this._sourceViewClickDelegate),$removeHandler(this._sourceViewDiv,"blur",this._sourceViewDivOnBlurDelegate));this._popupDiv!=null&&$removeHandler(this._btnCancel,"click",this._imageCancelClickDelegate);Sys.Extended.UI.HtmlEditorExtenderBehavior.callBaseMethod(this,"dispose")},_createContainer:function(){var t=this.get_element(),n;this._container=$common.createElementFromTemplate(this._containerTemplate,t.parentNode);this._elementVisible(this._textbox._element,!0);n=$common.getBounds(this._textbox._element);$common.setSize(this._container,{width:n.width,height:n.height});this._elementVisible(this._textbox._element,!1);$common.wrapElement(this._textbox._element,this._container,this._container)},_createTopButtonContainer:function(){this._topButtonContainer=$common.createElementFromTemplate(this._topButtonContainerTemplate,this._container)},_createButton:function(){var u=this,f=Sys.Browser.agent==Sys.Browser.InternetExplorer,n,r,t;for(i=0;i<this._toolbarButtons.length;i++)if(this._toolbarButtons[i].CommandName=="HorizontalSeparator")n=$common.createElementFromTemplate({nodeName:"span",cssClasses:["ajax__html_editor_extender_separator"]},this._topButtonContainer);else if(this._toolbarButtons[i].CommandName=="FontName"){n=$common.createElementFromTemplate({nodeName:"nobr",properties:{style:{float:"left",cssFloat:"left",fontSize:"11px"}},cssClasses:["ajax__html_editor_extender_fontnameclass"],children:[{nodeName:"span",properties:{textContent:"Font ",innerText:"Font ",style:{paddingLeft:"5px",fontWeight:"bold"}}}]},this._topButtonContainer);_select=$common.createElementFromTemplate({nodeName:"select",properties:{style:{fontSize:"9px",fontFamily:"Arial",height:"20px",width:"90px"}},events:{change:function(){var n=this.options[this.selectedIndex].value;setTimeout(function(){u.setFontFamily(n)},200)}}},n);r=[{Text:"Arial",Value:"arial,helvetica,sans-serif"},{Text:"Courier New",Value:"courier new,courier,monospace"},{Text:"Georgia",Value:"georgia,times new roman,times,serif"},{Text:"Tahoma",Value:"tahoma,arial,helvetica,sans-serif"},{Text:"Times New Roman",Value:"times new roman,times,serif"},{Text:"Verdana",Value:"verdana,arial,helvetica,sans-serif"},{Text:"Impact",Value:"impact"},{Text:"WingDings",Value:"wingdings"}];for(x in r){t=document.createElement("option");t.text=r[x].Text;t.value=r[x].Value;try{_select.add(t,null)}catch(e){_select.add(t)}}_select.setAttribute("id",this._id+this._toolbarButtons[i].CommandName);_select.setAttribute("name",this._toolbarButtons[i].CommandName);_select.setAttribute("title",this._toolbarButtons[i].Tooltip);_select.setAttribute("unselectable","on")}else if(this._toolbarButtons[i].CommandName=="FontSize"){n=$common.createElementFromTemplate({nodeName:"nobr",properties:{style:{float:"left",cssFloat:"left",fontSize:"11px"}},cssClasses:["ajax__html_editor_extender_fontsizeclass"],children:[{nodeName:"span",properties:{textContent:"Size ",innerText:"Size ",style:{paddingLeft:"5px",fontWeight:"bold"}}}]},this._topButtonContainer);_select=$common.createElementFromTemplate({nodeName:"select",properties:{style:{fontSize:"11px",fontFamily:"Arial",height:"20px",width:f?"30px":"50px"}},events:{change:function(){var n=this.options[this.selectedIndex].value;setTimeout(function(){u.setFontSize(n)},200)}}},n);r=[{Text:"1",Value:"1"},{Text:"2",Value:"2"},{Text:"3",Value:"3"},{Text:"4",Value:"4"},{Text:"5",Value:"5"},{Text:"6",Value:"6"},{Text:"7",Value:"7"}];for(x in r){t=document.createElement("option");t.text=r[x].Text;t.value=r[x].Value;try{_select.add(t,null)}catch(e){_select.add(t)}}_select.setAttribute("id",this._id+this._toolbarButtons[i].CommandName);_select.setAttribute("name",this._toolbarButtons[i].CommandName);_select.setAttribute("title",this._toolbarButtons[i].Tooltip);_select.setAttribute("unselectable","on")}else this._toolbarButtons[i].CommandName=="ForeColor"?(n=$common.createElementFromTemplate({nodeName:"span",properties:{style:{backgroundColor:"#ff0000",border:"solid 1px #c2c2c2",display:"block",float:"left",cssFloat:"left"}},cssClasses:["ajax__html_editor_extender_forecolorclass"]},this._topButtonContainer),n.setAttribute("unselectable","on"),this._foreColor=$common.createElementFromTemplate({nodeName:"input",properties:{type:"button",id:this._id+this._toolbarButtons[i].CommandName,name:this._toolbarButtons[i].CommandName,title:this._toolbarButtons[i].Tooltip,style:{backgroundColor:"transparent",width:"21px",height:"19px",color:"transparent"}},cssClasses:["ajax__html_editor_extender_button ajax__html_editor_extender_"+this._toolbarButtons[i].CommandName]},n),this._foreColor.setAttribute("unselectable","on")):this._toolbarButtons[i].CommandName=="BackColor"?(n=$common.createElementFromTemplate({nodeName:"span",properties:{style:{backgroundColor:"#ff0000",border:"solid 1px #c2c2c2",display:"block",float:"left",cssFloat:"left"}},cssClasses:["ajax__html_editor_extender_backcolorclass"]},this._topButtonContainer),n.setAttribute("unselectable","on"),this._backColor=$common.createElementFromTemplate({nodeName:"input",properties:{type:"button",id:this._id+this._toolbarButtons[i].CommandName,name:this._toolbarButtons[i].CommandName,title:this._toolbarButtons[i].Tooltip,style:{backgroundColor:"transparent",width:"21px",height:"19px",color:"transparent"}},cssClasses:["ajax__html_editor_extender_button ajax__html_editor_extender_"+this._toolbarButtons[i].CommandName]},n),this._backColor.setAttribute("unselectable","on")):(n=$common.createElementFromTemplate({nodeName:"input",properties:{type:"button",id:this._id+this._toolbarButtons[i].CommandName,name:this._toolbarButtons[i].CommandName,title:this._toolbarButtons[i].Tooltip,style:{width:"23px",height:"21px"}},cssClasses:["ajax__html_editor_extender_button ajax__html_editor_extender_"+this._toolbarButtons[i].CommandName]},this._topButtonContainer),n.setAttribute("unselectable","on"),Array.add(this._buttons,n))},setFontFamily:function(n){document.execCommand("styleWithCSS",!1,!0);document.execCommand("fontname",!1,n)},setFontSize:function(n){document.execCommand("styleWithCSS",!1,!0);document.execCommand("fontsize",!1,n)},_createEditableDiv:function(){var t=this.get_id(),n;this._elementVisible(this._container,!0);n=this.get_displaySourceTab()?this._container.clientHeight-(this._topButtonContainer.clientHeight+25):this._container.clientHeight-this._topButtonContainer.clientHeight;this._elementVisible(this._container,!1);this._editableDiv=$common.createElementFromTemplate({nodeName:"div",properties:{id:t+"_ExtenderContentEditable",style:{height:n+"px",overflow:"auto",clear:"both"},contentEditable:!0},cssClasses:["ajax__html_editor_extender_texteditor"]},this._container);this._textbox._element.value=this._textbox._element.value.replace(/&#x26;amp&#x3B;/g,"&#x26;");this._editableDiv.innerHTML=this._textbox._element.value;this._oldContents=this._editableDiv.innerHTML;$common.setVisible(this._textbox._element,!1)},_createTopButtonContainer2:function(){this._topButtonContainer2=$common.createElementFromTemplate(this._topButtonContainerTemplate2,this._container);this._contentViewButton=$common.createElementFromTemplate(this._buttonContentTemplate,this._topButtonContainer2);this._sourceViewButton=$common.createElementFromTemplate(this._buttonSourceTemplate,this._topButtonContainer2)},_createSourceViewDiv:function(){var n=this.get_id(),t=this._container.clientHeight-25;this._sourceViewDiv=$common.createElementFromTemplate({nodeName:"div",properties:{id:n+"_ExtenderSourceView",style:{height:t+"px",overflow:"auto",clear:"both"},contentEditable:!0},cssClasses:["ajax__html_editor_extender_texteditor"]},this._container);$common.setVisible(this._sourceViewDiv,!1)},_editableDiv_onblur:function(){this._textbox._element.value=this._encodeHtml();this._isFocusInEditableDiv=!1;this._oldContents!=this._editableDiv.innerHTML&&(this._isDirty=!0,this._oldContents=this._editableDiv.innerHTML,this._raiseEvent("change"))},_editableDiv_onfocus:function(){this._isFocusInEditableDiv=!1},_sourceViewDiv_onblur:function(){this._oldContents!=(this._sourceViewDiv.innerText||this._sourceViewDiv.textContent)&&(this._isDirty=!0,this._editableDiv.innerHTML=this._sourceViewDiv.textContent!=undefined?this._sourceViewDiv.textContent:this._sourceViewDiv.innerText,this._oldContents=this._editableDiv.innerHTML,this._raiseEvent("change"))},_textBox_onblur:function(){this._editableDiv.innerHTML=this._textbox._element.value},_contentView_click:function(){this._viewMode!="content"&&($common.setVisible(this._topButtonContainer,!0),$common.setVisible(this._editableDiv,!0),this._editableDiv.innerHTML=this._sourceViewDiv.textContent!=undefined?this._sourceViewDiv.textContent:this._sourceViewDiv.innerText,this._oldContents=this._editableDiv.innerHTML,$common.setVisible(this._sourceViewDiv,!1),this._viewMode="content")},_sourceView_click:function(){this._viewMode!="source"&&($common.setVisible(this._sourceViewDiv,!0),this._sourceViewDiv.textContent!=undefined?this._sourceViewDiv.textContent=this.cleanHtml(this._editableDiv.innerHTML):this._sourceViewDiv.innerText=this.cleanHtml(this._editableDiv.innerHTML),this._oldContents=this._editableDiv.innerHTML,$common.setVisible(this._editableDiv,!1),$common.setVisible(this._topButtonContainer,!1),this._viewMode="source")},cleanHtml:function(n){return n.replace(/<br>/g,"<br />")},_btnCancel_click:function(){this._popupBehavior.hide()},_rgbToHex:function(n){var t=/rgb\s?\(\s?(\d+)\s?,\s?(\d+)\s?,\s?(\d+)\s?\)/.exec(n);return"#"+(parseInt(t[3],10)|parseInt(t[2],10)<<8|parseInt(t[1],10)<<16).toString(16)},_encodeHtml:function(){var u=Sys.Browser.agent==Sys.Browser.InternetExplorer,f=this._editableDiv.getElementsByTagName("*"),n=this._editableDiv.innerHTML,i,r,t;return u&&(i=/\<[^\>]+\>/g,n=n.replace(i,function(n){var t="",i="";return n.toLowerCase().substring(0,2)!="<a"?(t=/\=\'([^\'])*\'/g,i=/\=([^\"][^\s\/\>]*)/g,n.replace(t,'="$1"').replace(i,"=$1")):n})),r=this._rgbToHex,t=function(){n=n.replace(/(\<[^\>]+)(rgb\s?\(\d{1,3}\s?\,\s?\d{1,3}\s?\,\s?\d{1,3}\s?\))([^\>]*\>)/gi,function(n,t,i,u){return(t||"")+(i&&r(i)||"")+(u||"")})},t(),t(),n=n.replace(/\sclass\=\"\"/gi,"").replace(/\sid\=\"\"/gi,""),n=n.replace(/\<(\/?)strong\>/gi,"<$1b>").replace(/\<(\/?)em\>/gi,"<$1i>"),n=n.replace(/&(?!g|lt;)/ig,"&amp;").replace(/\xA0/ig,"&nbsp;"),n=n.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\'/ig,"&apos;").replace(/\"/ig,"&quot;")},_editableDiv_submit:function(){this._textbox._element.value=this._encodeHtml()},_isHtmlElement:function(n){return n instanceof HTMLElement?!0:!1},isValidTarget:function(n){return n.name==undefined||n.name==""||n.tagName.toLowerCase()=="select"?!1:!0},isSimpleTextDecoration:function(n){return n?n.toLowerCase()=="bold"||n.toLowerCase()=="italic"||n.toLowerCase()=="underline":!1},_executeCommand:function(n){var u,h,l,t,e,y,o,r,s,p,w;if(this.isValidTarget(n.target)&&(u=this._getSelection(),u==null||(h=this._isDescendantOrSelf(this._editableDiv,u.commonAncestorContainer),h))){var b=Sys.Browser.agent==Sys.Browser.Firefox,k=Sys.Browser.agent==Sys.Browser.Safari,d=Sys.Browser.agent==Sys.Browser.InternetExplorer||Sys.Browser.agent==null,c=Function.createDelegate(this,this._colorPicker_onchange);if(this.isSimpleTextDecoration(n.target.name)||document.execCommand("styleWithCSS",!1,!0),l={JustifyRight:1,JustifyLeft:1,JustifyCenter:1,JustifyFull:1,Outdent:1},l[n.target.name])try{document.execCommand(n.target.name,!1,null)}catch(f){if(f&&f.result==2147500037){var a=window.getSelection().getRangeAt(0),i=document.createElement("div"),v=!1;for(i.style.height="1px;",a.startContainer.contentEditable=="true"&&(window.getSelection().collapseToEnd(),v=!0),t=window.getSelection().getRangeAt(0).startContainer;t&&t.contentEditable!="true";)t=t.parentNode;if(!t)throw"Selected node is not editable!";t.insertBefore(i,t.childNodes[0]);document.execCommand(n.target.name,!1,null);i.parentNode.removeChild(i);v&&window.getSelection().addRange(a)}else window.console&&window.console.log&&window.console.log(f)}else if(n.target.name=="createLink")e=prompt("Please insert  URL",""),e&&document.execCommand("createLink",!1,e);else if(n.target.name=="ForeColor")this._commandName=n.target.name,this.saveSelection(),this._foreColorPicker||(this._foreColorPicker=$create(Sys.Extended.UI.ColorPickerBehavior,{},{},{},this._foreColor),this._foreColorPicker.set_sample(this._foreColor.parentNode),this._foreColorPicker.add_colorSelectionChanged(c)),this._foreColorPicker.show();else if(n.target.name=="BackColor")this._commandName=n.target.name,this.saveSelection(),this._backColorPicker||(this._backColorPicker=$create(Sys.Extended.UI.ColorPickerBehavior,{},{},{},this._backColor),this._backColorPicker.set_sample(this._backColor.parentNode),this._backColorPicker.add_colorSelectionChanged(c)),this._backColorPicker.show();else if(n.target.name=="UnSelect")b?(this._editableDiv.focus(),y=window.getSelection(),y.collapse(this._editableDiv.firstChild,0)):document.execCommand(n.target.name,!1,null);else if(n.target.name=="InsertImage"){for(this._isFocusInEditableDiv||this._editableDiv.focus(),this.saveSelection(),o=Sys.Application.getComponents(),r=0;r<o.length;r++)if(s=o[r],Sys.Extended.UI.HtmlEditorExtenderBehavior.isInstanceOfType(s)&&s._popupBehavior._visible)return;this._elementVisible(this._popupDiv,!0);this._popupBehavior.show();$common.setStyle(this._popupDiv,{position:"fixed",top:"",left:"",opacity:"1"})}else n.target.name=="CleanWord"?this._editableDiv.innerHTML=this.cleanWordHtml(this._editableDiv.innerHTML):n.target.name=="Indent"?d?document.execCommand(n.target.name,!1,null):(p=this._getSelectionHtml(),w='<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>'+p+"<\/div><\/blockquote>",document.execCommand("insertHTML",!1,w)):n.target.name=="InsertHorizontalRule"?k?document.execCommand("insertHTML",!1,"<hr />"):document.execCommand(n.target.name,!1,null):document.execCommand(n.target.name,!1,null)}},_colorPicker_onchange:function(n){this.restoreSelection();this.setColor(this._commandName,"#"+n._selectedColor)},setColor:function(n,t){if(/backcolor/i.test(n)){var i=Sys.Browser.agent==Sys.Browser.Firefox;i?(document.execCommand("stylewithcss",!1,!0),document.execCommand("hilitecolor",!1,t),document.execCommand("stylewithcss",!1,!1)):document.execCommand("backcolor",!1,t)}else document.execCommand("stylewithcss",!1,!0),document.execCommand(n,!1,t)},saveSelection:function(){this instanceof Sys.Extended.UI.HtmlEditorExtenderBehavior&&(this._savedRange=this._getSelection())},_getSelection:function(){return window.getSelection?window.getSelection().rangeCount&&window.getSelection().getRangeAt(0):document.selection?document.selection.createRange():null},_getSelectionHtml:function(){var n,t,r,i;return window.getSelection?(n=window.getSelection(),n.getRangeAt?t=n.getRangeAt(0):(t=document.createRange(),t.setStart(n.anchorNode,n.anchorOffset),t.setEnd(n.focusNode,n.focusOffset)),r=t.cloneContents(),i=document.createElement("div"),i.appendChild(r),i.innerHTML):document.selection?(n=document.selection.createRange(),n.htmlText):""},_isDescendantOrSelf:function(n,t){if(!n||!t)return!1;if(n==t)return!0;for(var i=t.parentNode;i!=null;){if(i==n)return!0;i=i.parentNode}return!1},restoreSelection:function(){if(this._isInFocus=!0,this._savedRange!=null)if(window.getSelection){var n=window.getSelection();n.rangeCount>0&&n.removeAllRanges();n.addRange(this._savedRange)}else document.createRange?window.getSelection().addRange(this._savedRange):document.selection&&this._savedRange.select()},cleanWordHtml:function(n){return n=this._cleanOP(n),n=this._cleanMSO(n),n=this._cleanStyleAttr(n),n=this._cleanLangAttr(n),n=this._cleanXmlNamespaceTags(n),n=this._cleanComments(n),n=this._cleanFontFamily(n),n=this._cleanSpan(n),this._cleanB(n)},_cleanOP:function(n){return n=n.replace(/<o:p>\s*<\/o:p>/g,""),n.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;")},_cleanMSO:function(n){return n.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"")},_cleanFontFamily:function(n){return n.replace(/\s*FONT-FAMILY:[^;"]*;?/gi,"")},_cleanSpan:function(n){return n=n.replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,"&nbsp;"),n=n.replace(/<SPAN\s*[^>]*><\/SPAN>/gi,""),n=n.replace(/<SPAN\s*>([\s\S]*?)<\/SPAN>/gi,"$1"),n.replace(/<span>\s*<\/span>/gi,"")},_cleanStyleAttr:function(n){return n.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gi,"<$1$3")},_cleanLangAttr:function(n){return n.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3")},_cleanXmlNamespaceTags:function(n){return n.replace(/<\/?\w+:[^>]*>/gi,"")},_cleanComments:function(n){return n.replace(/<\!--[\s\S]*?-->/g,"")},_cleanB:function(n){return n=n.replace(/<b>\s*&nbsp;\s*<\/b>/gi,""),n.replace(/<b>\s*<\/b>/gi,"")},_elementVisible:function(n,t){n.tagName!="FORM"&&(t?(n.style.display=="none"&&(n.style.display="block",n.setAttribute("displayChanged",!0)),n.style.visibility=="hidden"&&(n.style.visibility="visible",n.setAttribute("visibleChanged",!0)),this._elementVisible(n.parentNode,!0)):(n.getAttribute("displayChanged")&&(n.style.display="none",n.removeAttribute("displayChanged")),n.getAttribute("visibleChanged")&&n.removeAttribute("visibleChanged"),this._elementVisible(n.parentNode,!1)))},_raiseEvent:function(n,t){var i=this.get_events().getHandler(n);i&&(t||(t=Sys.EventArgs.Empty),i(this,t))},get_buttonWidth:function(){return this._ButtonWidth},get_ButtonWidth:function(){return Sys.Extended.Deprecated("get_ButtonWidth()","get_buttonWidth()"),this.get_buttonWidth()},set_buttonWidth:function(n){this._ButtonWidth!=n&&(this._ButtonWidth=n,this.raisePropertyChanged("ButtonWidth"))},set_ButtonWidth:function(n){Sys.Extended.Deprecated("set_ButtonWidth(value)","set_buttonWidth(value)");this.set_buttonWidth(n)},get_buttonHeight:function(){return this._ButtonHeight},get_ButtonHeight:function(){return Sys.Extended.Deprecated("get_ButtonHeight()","get_buttonHeight()"),this.get_buttonHeight()},set_buttonHeight:function(n){this._ButtonHeight!=n&&(this._ButtonHeight=n,this.raisePropertyChanged("ButtonHeight"))},set_ButtonHeight:function(){Sys.Extended.Deprecated("set_ButtonHeight(value)","set_buttonHeight(value)");this.set_buttonHeight()},get_toolbarButtons:function(){return this._toolbarButtons},get_ToolbarButtons:function(){return Sys.Extended.Deprecated("get_ToolbarButtons()","get_toolbarButtons()"),this.get_toolbarButtons()},set_toolbarButtons:function(n){this._toolbarButtons!=n&&(this._toolbarButtons=n,this.raisePropertyChanged("ToolbarButtons"))},set_ToolbarButtons:function(n){Sys.Extended.Deprecated("set_ToolbarButtons(value)","set_ToolbarButtons(value)");this.set_toolbarButtons(n)},get_displaySourceTab:function(){return this._displaySourceTab},set_displaySourceTab:function(n){this._displaySourceTab!=n&&(this._displaySourceTab=n,this.raisePropertyChanged("DisplaySourceTab"))},add_change:function(n){this.get_events().addHandler("change",n)},remove_change:function(n){this.get_events().removeHandler("change",n)},get_isDirty:function(){return this._isDirty}};Sys.Extended.UI.HtmlEditorExtenderBehavior.registerClass("Sys.Extended.UI.HtmlEditorExtenderBehavior",Sys.Extended.UI.BehaviorBase);var HtmlEditorExtender_editableDivs=[];Sys.Extended.UI.HtmlEditorExtenderBehavior.WebForm_OnSubmit=function(){var r=Sys.Extended.UI.HtmlEditorExtenderBehavior._originalWebForm_OnSubmit(),t,n,i;if(r)for(t=Sys.Application.getComponents(),n=0;n<t.length;n++)i=t[n],Sys.Extended.UI.HtmlEditorExtenderBehavior.isInstanceOfType(i)&&i._editableDiv_submit();return r};Sys.Extended.UI.HtmlEditorExtenderBehavior.IsDirty=function(){for(var t,i=Sys.Application.getComponents(),n=0;n<i.length;n++)if(t=i[n],Sys.Extended.UI.HtmlEditorExtenderBehavior.isInstanceOfType(t)&&t._isDirty)return!0;return!1};ajaxClientUploadComplete=function(n,t){for(var u,e,r,i=null,o=Sys.Application.getComponents(),f=0;f<o.length;f++)u=o[f],Sys.Extended.UI.HtmlEditorExtenderBehavior.isInstanceOfType(u)&&u._popupBehavior._visible&&(i=u,f=u.length);if(e=t.get_postedUrl().replace("&amp;","&"),i!=null)if(i.restoreSelection(),document.selection&&document.selection.createRange)try{i._savedRange.pasteHTML("<img src='"+e+"' />")}catch(s){r=document.createElement("img");r.src=e;i._savedRange.insertNode(r)}else r=document.createElement("img"),r.src=e,i._savedRange.insertNode(r)};