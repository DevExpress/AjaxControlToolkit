if(Type.registerNamespace("Sys.Extended.UI.HtmlEditor"),Sys.Extended.UI.HtmlEditor.Trim=function(e){return e.replace(/[\x00-\x1F]+/g,"")},Sys.Extended.UI.HtmlEditor.TrimAll=function(e){return e.replace(/[\x00-\x1F]/g,"").replace(/^[\x20]+/g,"").replace(/[\x20]+$/g,"")},Sys.Extended.UI.HtmlEditor.isIE=Sys.Browser.agent==Sys.Browser.InternetExplorer,Sys.Extended.UI.HtmlEditor.isSafari=Sys.Browser.agent==Sys.Browser.Safari||null==Sys.Browser.agent&&5==Sys.Browser.version&&"Netscape"==Sys.Browser.name,Sys.Extended.UI.HtmlEditor.isOpera=Sys.Browser.agent==Sys.Browser.Opera,Sys.Extended.UI.HtmlEditor.tryReplaceRgb=function(e){function t(e){return e<16?"0"+e.toString(16):e.toString(16)}function r(e,r,n,i,d){var l=parseInt(n),o=parseInt(i),a=parseInt(d);return"#"+t(l)+t(o)+t(a)}var n=e,i=/(rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\))/gi;try{n=n.replace(i,r)}catch(e){}return n},Sys.Extended.UI.HtmlEditor._getScrollTop=function(e){var t=e.document,r=0;return"number"==typeof e.pageYOffset&&(r=e.pageYOffset),t.body&&t.body.scrollTop?r=t.body.scrollTop:t.documentElement&&t.documentElement.scrollTop&&(r=t.documentElement.scrollTop),r},Sys.Extended.UI.HtmlEditor._getScrollLeft=function(e){var t=e.document,r=0;return"number"==typeof e.pageXOffset?r=e.pageXOffset:t.body&&t.body.scrollLeft?r=t.body.scrollLeft:t.documentElement&&t.documentElement.scrollLeft&&(r=t.documentElement.scrollLeft),r},Sys.Extended.UI.HtmlEditor.addFormOnSubmit=function(e,t){var r=window.theForm;null!=window.theForm&&"undefined"!=typeof window.theForm&&(null!=r.HtmlEditor_editPanels&&"undefined"!=typeof r.HtmlEditor_editPanels||(r.originalOnSubmit_HtmlEditor=window.theForm.onsubmit,r.HtmlEditor_editPanels=[],window.theForm.onsubmit=Sys.Extended.UI.HtmlEditor.EditPanelsOnSubmit,null!=window.__doPostBack&&"undefined"!=typeof window.__doPostBack&&(null!=window.__doPostBack_HtmlEditor_original&&"undefined"!=typeof window.__doPostBack_HtmlEditor_original||(window.__doPostBack_HtmlEditor_original=window.__doPostBack,window.__doPostBack=Sys.Extended.UI.HtmlEditor.EditPanelsOnPostBack)),null!=window.ValidatorGetValue&&"undefined"!=typeof window.ValidatorGetValue&&(null!=window.ValidatorGetValue_HtmlEditor_original&&"undefined"!=typeof window.ValidatorGetValue_HtmlEditor_original||(window.ValidatorGetValue_HtmlEditor_original=window.ValidatorGetValue,window.ValidatorGetValue=Sys.Extended.UI.HtmlEditor.ValidatorGetValue))),r.HtmlEditor_editPanels.push({handler:e,editPanel:t}))},Sys.Extended.UI.HtmlEditor.removeFormOnSubmit=function(e){var t=window.theForm;if(null!=window.theForm&&"undefined"!=typeof window.theForm){var r=t.originalOnSubmit_HtmlEditor;if(null!=t.HtmlEditor_editPanels&&"undefined"!=typeof t.HtmlEditor_editPanels){for(var n=[],i=0;i<t.HtmlEditor_editPanels.length;i++){var d=t.HtmlEditor_editPanels[i];d.handler!=e&&n.push(d)}t.HtmlEditor_editPanels=n,0==t.HtmlEditor_editPanels.length&&(window.theForm.onsubmit=r,t.originalOnSubmit_HtmlEditor=null,t.HtmlEditor_editPanels=null,null!=window.__doPostBack_HtmlEditor_original&&"undefined"!=typeof window.__doPostBack_HtmlEditor_original&&(window.__doPostBack=window.__doPostBack_HtmlEditor_original,window.__doPostBack_HtmlEditor_original=null),null!=window.ValidatorGetValue_HtmlEditor_original&&"undefined"!=typeof window.ValidatorGetValue_HtmlEditor_original&&(window.ValidatorGetValue=window.ValidatorGetValue_HtmlEditor_original,window.ValidatorGetValue_HtmlEditor_original=null))}}},Sys.Extended.UI.HtmlEditor.EditPanelsOnSubmit=function(e){for(var t=window.theForm,r=!0,n=0;n<t.HtmlEditor_editPanels.length;n++){var r=t.HtmlEditor_editPanels[n].handler(e);if(!r)break}if(r&&null!=t.originalOnSubmit_HtmlEditor&&"undefined"!=typeof t.originalOnSubmit_HtmlEditor&&(r=t.originalOnSubmit_HtmlEditor(e)),!r||!window.Page_IsValid)for(var n=0;n<t.HtmlEditor_editPanels.length;n++)t.HtmlEditor_editPanels[n].editPanel._contentPrepared=!1;return r},Sys.Extended.UI.HtmlEditor.ValidatorGetValue=function(e){var t=$find(e);if(null!=t){var r=null;if(Sys.Extended.UI.HtmlEditor.Editor.isInstanceOfType(t)?r=t.get_editPanel():Sys.Extended.UI.HtmlEditor.EditPanel.isInstanceOfType(t)&&(r=t),null!=r){var n=r._contentForValidation;return null!=n&&"undefined"!=typeof n||(n=r.get_content()),n}}return window.ValidatorGetValue_HtmlEditor_original(e)},Sys.Extended.UI.HtmlEditor.EditPanelsOnPostBack=function(e,t){for(var r=window.theForm,n=0;n<r.HtmlEditor_editPanels.length;n++){var i=r.HtmlEditor_editPanels[n].handler(null);if(!i)return!1}return null==window.__doPostBack_HtmlEditor_original||"undefined"==typeof window.__doPostBack_HtmlEditor_original||window.__doPostBack_HtmlEditor_original(e,t)},Sys.Extended.UI.HtmlEditor.getRealAttributeIE=function(e,t,r){function n(e,t){d=t}var i=r,d="";return e.outerHTML.replace(new RegExp("^(?:<[^>]*?"+t+'=")([^"]*?)"',"ig"),n),""==d&&e.outerHTML.replace(new RegExp("^(?:<[^>]*?"+t+"=')([^']*?)'","ig"),n),""==d&&e.outerHTML.replace(new RegExp("^(?:<[^>]*?"+t+"=)([^s>]*?)","ig"),n),i!=d&&""!=d&&(i=d,i=i.replace(/&amp;/g,"&")),i},Sys.Extended.UI.HtmlEditor.getRealAttribute=function(e,t){var r=t.toLowerCase(),n=e.attributes,d="";for(i=0;i<n.length;++i){var l=n.item(i);if(l.specified){var t=l.name.toLowerCase();if(t==r){d=l.value,Sys.Extended.UI.HtmlEditor.isIE&&(d=Sys.Extended.UI.HtmlEditor.getRealAttributeIE(e,t,d)),"src"!=t&&"href"!=t||(d=d.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,""));break}}}return d},Sys.Extended.UI.HtmlEditor.enabledWordTags=["img","strong","p","b","i","u","a","h1","h2","h3","h4","h5","h6","table","tbody","tr","td","ul","ol","li","span","div","font","xml","del","ins","em","sub","sup","hr","br"],Sys.Extended.UI.HtmlEditor.cleanUp=function(e){function t(e){for(var r=e.childNodes.length,n=0;n<e.childNodes.length;n++){var i=e.childNodes.item(n);if(1==i.nodeType)if(i.tagName.indexOf("/")>=0)n--,i.parentNode.removeChild(i);else{for(var d=i.tagName.toLowerCase(),l=!1,o=Sys.Extended.UI.HtmlEditor.enabledWordTags.length,a=0;a<o;a++)if(Sys.Extended.UI.HtmlEditor.enabledWordTags[a]==d){l=!0;break}if(t(i),l){var s=i.style.backgroundColor,m=i.style.color;i.style.cssText="",i.removeAttribute("style"),i.getAttribute("width")&&i.getAttribute("width").length>0&&(i.style.width=i.getAttribute("width")),i.width&&i.width.length>0&&(i.style.width=i.width),i.width="";try{i.removeAttribute("width")}catch(e){}i.getAttribute("height")&&i.getAttribute("height").length>0&&(i.style.height=i.getAttribute("height")),i.height&&i.height.length>0&&(i.style.height=i.height),i.height="";try{i.removeAttribute("height")}catch(e){}if("table"==d&&(i.style.borderLeftWidth="1px",i.style.borderLeftColor="black",i.style.borderLeftStyle="solid",i.style.borderTopWidth="1px",i.style.borderTopColor="black",i.style.borderTopStyle="solid",i.style.backgroundColor=s,i.style.color=m),"td"==d&&(i.style.borderRightWidth="1px",i.style.borderRightColor="black",i.style.borderRightStyle="solid",i.style.borderBottomWidth="1px",i.style.borderBottomColor="black",i.style.borderBottomStyle="solid",i.style.backgroundColor=s,i.style.color=m),"font"==d||"span"==d){i.style.backgroundColor=s,i.style.color=m;for(var E=i.attributes,r=0,f=0;f<E.length;++f){var p=E.item(f);p.specified&&r++}if(0==r&&""==i.style.cssText){for(n+=i.childNodes.length;i.firstChild;)i.parentNode.insertBefore(i.firstChild,i);i.parentNode.removeChild(i),n--}}}else{for(n+=i.childNodes.length;i.firstChild;)i.parentNode.insertBefore(i.firstChild,i);i.parentNode.removeChild(i),n--}}}}var r,n=Sys.Extended.UI.HtmlEditor.Trim(e.replace(/[\x00-\x1F]+/g," ")).replace(/^[^\u0000]+?<html(?:[^>]*?)>/gi,"").replace(/<\/html(?:[^>]*?)>[^\u0000]*$/gi,"").replace(/<head(?:[^>]*?)>[^\u0000]*?<\/head(?:[^>]*?)>/gi,"").replace(/<body[^>]*?>([^\u0000]*?)<\/body(?:[^>]*?)>/gi,"$1").replace(/<\/?html(?:[^>]*?)>/gi,"").replace(/<\/?head(?:[^>]*?)>/gi,"").replace(/<\/?body(?:[^>]*?)>/gi,"").replace(/<!--(\w|\W)+?-->/gi,"").replace(/(<[\/]?)(?:o|v|x|p|w|\?xml):(\w+)([^>]*?>)/gi,"$1$2$3").replace(/<(IMAGEDATA)([^>]*?)>/gi,"<img$2>").replace(/<p[^>]*><p>&nbsp;<\/p><\/p>/gi,"<br>").replace(/<p[^>]*?\/>/gi,"").replace(/<(p|div)[^>]*?>&nbsp;<\/(\1)[^>]*?>/gi,"").replace(/<(p|div)[^>]*?><\/(\1)[^>]*?>/gi,"");do r=n,n=n.replace(/<([^>]*)(?:class|size|lang|face|start|type|border|[ovwxp]:\w+)=(?:\'[^\']*\'|\"[^\"]*\"|[^> ]+)([^>]*)>/gi,"<$1$2>");while(n!=r);var i=document.createElement("div");i.innerHTML=n,t(i),n=Sys.Extended.UI.HtmlEditor.Trim(i.innerHTML),delete i,n=n.replace(/<[\/]?(xml|del|ins)[^>]*?>/gi,"").replace(/<(p|div)[^>]*?>/gi,"").replace(/<\/(p|div)[^>]*?>/gi,"<br>");do r=n,n=n.replace(/<b><\/b>/gi,"").replace(/<i><\/i>/gi,"").replace(/<u><\/u>/gi,"").replace(/<strong><\/strong>/gi,"").replace(/<em><\/em>/gi,"").replace(/<sub><\/sub>/gi,"").replace(/<sup><\/sup>/gi,""),n=n.replace(/<span[^>]*?><\/span>/gi,"").replace(/<span>([^<]+?)<\/span>/gi,"$1"),n=n.replace(/<font[^>]*?><\/font>/gi,"").replace(/<font>([^<]+?)<\/font>/gi,"$1");while(n!=r);return n=n.replace(/&rsquo;/g,"'").replace(/&lsquo;/g,"'").replace(/&ndash;/g,"-").replace(/&mdash;/g,"-").replace(/&hellip;/g,"...").replace(/&quot;/g,'"').replace(/&ldquo;/g,'"').replace(/&rdquo;/g,'"').replace(//g,"").replace(/&bull;/g,"").replace(/[ \s]+/g," ").replace(/((&nbsp;)+)/g,"&nbsp;"),document.all&&(n=n.replace(/^[\x00-\x1F]*&nbsp;/,"")),n},Sys.Extended.UI.HtmlEditor.spanJoiner=function(e,t,r,n,i){var d=0,l=e.childNodes.length;"undefined"!=typeof r&&null!=r&&(d=r),"undefined"!=typeof n&&null!=n&&(l=n);for(var o=d;o<l&&o<e.childNodes.length;o++){var a=e.childNodes.item(o);if(a.parentNode==e)switch(a.nodeType){case 1:if(0==a.childNodes.length&&Sys.Extended.UI.HtmlEditor.isStyleTag(a.tagName)&&"A"!=a.tagName.toUpperCase()&&!(a.className.length>0||a.getAttribute("class")&&a.getAttribute("class").length>0)&&!Sys.Extended.UI.HtmlEditor.isTempElement(a)){e.removeChild(a),o--,l--;continue}if("SPAN"==a.tagName.toUpperCase()){for(;1==a.childNodes.length&&1==a.firstChild.nodeType;){if("SPAN"!=a.firstChild.tagName.toUpperCase()||Sys.Extended.UI.HtmlEditor.isTempElement(a.firstChild)){if("SPAN"==a.firstChild.tagName.toUpperCase()&&Sys.Extended.UI.HtmlEditor.isTempElement(a.firstChild)){var s=a.firstChild;a.parentNode.insertBefore(a.firstChild,a),a.parentNode.removeChild(a),a=s}break}var m=Sys.Extended.UI.HtmlEditor.differAttr(a.firstChild,[]),E=Sys.Extended.UI.HtmlEditor.differStyle(a.firstChild),f=a.firstChild;for(f.childNodes;null!=f.firstChild;)a.insertBefore(f.firstChild,f);for(var p=0;p<E.length;p++)if(E[p][1])try{if(a.style[E[p][0]])if(E[p][0].toLowerCase().indexOf("color")>=0)a.style[E[p][0]]=E[p][1];else try{var c=a.style[E[p][0]];a.style[E[p][0]]=a.style[E[p][0]]+" "+E[p][1],c==a.style[E[p][0]]&&(a.style[E[p][0]]=E[p][1])}catch(e){a.style[E[p][0]]=E[p][1]}else a.style[E[p][0]]=E[p][1]}catch(e){}for(var p=0;p<m.length;p++)m[p][1]&&a.setAttribute(m[p][0],m[p][1]);a.removeChild(f)}for(var g=[],u=a.nextSibling;!Sys.Extended.UI.HtmlEditor.isTempElement(a)&&u&&o+1<l&&(3==u.nodeType||1==u.nodeType&&("SPAN"==u.tagName.toUpperCase()||"BR"==u.tagName.toUpperCase()&&"undefined"==typeof i)&&!Sys.Extended.UI.HtmlEditor.isTempElement(u));)if(3==u.nodeType){if(0!=(""+u.data).length)break;u.parentNode.removeChild(u),u=a.nextSibling,l--}else if("BR"==u.tagName.toUpperCase())g.push(u),u=u.nextSibling;else{var m=Sys.Extended.UI.HtmlEditor.differAttr(a,[],u),E=Sys.Extended.UI.HtmlEditor.differStyle(a,u);if(0!=m.length||0!=E.length||a.className!=u.className)break;for(var y=g.length,p=0;p<y;p++)a.appendChild(g[p]),l--;for(g=[];u.firstChild;)a.appendChild(u.firstChild);u.parentNode.removeChild(u),u=a.nextSibling,l--}if(!Sys.Extended.UI.HtmlEditor.isTempElement(a)&&0==a.className.length){var m=Sys.Extended.UI.HtmlEditor.differAttr(a,[]),E=Sys.Extended.UI.HtmlEditor.differStyle(a);if(0==m.length&&0==E.length){for(o--,l--;a.firstChild;)a.parentNode.insertBefore(a.firstChild,a),l++;a.parentNode.removeChild(a);continue}}}if(null!=a.parentNode){if(0==a.childNodes.length&&Sys.Extended.UI.HtmlEditor.isStyleTag(a.tagName)&&"A"!=a.tagName.toUpperCase()&&!(a.className.length>0||a.getAttribute("class")&&a.getAttribute("class").length>0)&&!Sys.Extended.UI.HtmlEditor.isTempElement(a)){e.removeChild(a),o--,l--;continue}Sys.Extended.UI.HtmlEditor.spanJoiner(a,t)}}}},Sys.Extended.UI.HtmlEditor._styleTags=["strong","em","u","strike","s","span","font","b","sub","sup","a","i"],Sys.Extended.UI.HtmlEditor.isStyleTag=function(e){if(!e)return!1;for(var t=0;t<Sys.Extended.UI.HtmlEditor._styleTags.length;t++)if(Sys.Extended.UI.HtmlEditor._styleTags[t].toLowerCase()==e.toLowerCase())return!0;return!1},Sys.Extended.UI.HtmlEditor.smartClassName="MSIEparagraph",Sys.Extended.UI.HtmlEditor.noContextMenuAttribute="obout-no-contextmenu",Sys.Extended.UI.HtmlEditor.isTempElement=function(e){return!!(e.id&&e.id.length>0&&e.id.indexOf(Sys.Extended.UI.HtmlEditor.smartClassName)>=0)},Sys.Extended.UI.HtmlEditor.differAttr=function(e,t,r){var n=[],i=e.parentNode;if("undefined"!=typeof r&&(i=r),i&&i.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(i.tagName)||(i=null),e.attributes)for(var d=0;d<e.attributes.length;d++){for(var l=e.attributes[d],o=!1,a=0;a<t.length;a++)if(l.name.toUpperCase()==t[a].toUpperCase()){o=!0;break}if(!o&&"STYLE"!=l.name.toUpperCase()&&"_MOZ"!=l.name.toUpperCase().substr(0,4)&&l.specified)if(i&&i.attributes&&i.attributes[l.name]){var s=i.attributes[l.name];s&&(l.name==s.name&&l.value==s.value||n.push([l.name,l.value]))}else{if("CLASS"==l.name.toUpperCase()&&""==l.value)continue;n.push([l.name,l.value])}}return n},Sys.Extended.UI.HtmlEditor.differStyle=function(e,t){function r(e,t){if(t=""+t,"textdecoration"==e.toLowerCase())for(var r=t.split(" "),i=0;i<r.length;i++)n.push([e,Sys.Extended.UI.HtmlEditor.Trim(r[i])]);else n.push([e,t])}var n=[],i=e.parentNode;"undefined"!=typeof t&&(i=t),i&&i.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(i.tagName)||(i=null);for(var d in e.style)if(d&&"string"==typeof d&&"accelerator"!=d){var l=d;if(!isNaN(parseInt(d))){if(!Sys.Extended.UI.HtmlEditor.isSafari)continue;l=e.style[d]}var o=e.style[l];if(o&&"string"==typeof o&&"accelerator"!=o)if(i&&i.style){var a=i.style[l];"csstext"!=l.toLowerCase()&&"length"!=l.toLowerCase()&&o!=a&&r(l,o)}else"csstext"!=l.toLowerCase()&&"length"!=l.toLowerCase()&&r(l,o)}if("undefined"!=typeof t)for(var d in i.style)if(d&&"string"==typeof d&&"accelerator"!=d){var l=d;if(!isNaN(parseInt(d))){if(!Sys.Extended.UI.HtmlEditor.isSafari)continue;l=e.style[d]}var o=i.style[l];if(o&&"string"==typeof o&&"accelerator"!=o){var a=e.style[l];"csstext"!=d.toLowerCase()&&"length"!=l.toLowerCase()&&o!=a&&r(l,o)}}return n},Sys.Extended.UI.HtmlEditor.brXHTML=function(e){return e.replace(/<br>/gi,"<br/>")},Sys.Extended.UI.HtmlEditor._needsClosingTag=function(e){var t=" script style div span a del strong em u strike font b sub sup p iframe li ul ol placeholder textarea td tr ";return t.indexOf(" "+e.tagName.toLowerCase()+" ")!=-1},Sys.Extended.UI.HtmlEditor._encodeText_=function(e){return e.replace(/&/gi,"&amp;").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\"/gi,"&quot;").replace(/\xA0/gi,"&nbsp;")},Sys.Extended.UI.HtmlEditor._noNeedsClosingTag=function(e){var t=" hr br ";return t.indexOf(" "+e.tagName.toLowerCase()+" ")!=-1},Sys.Extended.UI.HtmlEditor.canBeInsideP=function(e,t){if(e&&e.style&&e.style.display&&"inline"==e.style.display.toLowerCase())return!0;var r=e.tagName.toUpperCase();if(2==r.length&&"H"==r.substr(0,1)&&parseInt(r.substr(1,1))>0)return!1;switch(r){case"TBODY":case"TR":case"TD":if("undefined"!=typeof t){for(var n=e.parentNode;n&&n.tagName&&"TABLE"!=n.tagName.toUpperCase();)n=n.parentNode;if("TABLE"==n.tagName.toUpperCase()&&n.style&&n.style.display&&"inline"==n.style.display.toLowerCase())return!0}case"P":case"PRE":case"TABLE":case"OL":case"UL":case"LI":case"HR":case"DIV":case"BLOCKQUOTE":case"FORM":case"FIELDSET":case"LEGEND":return!1;default:return!0}},Sys.Extended.UI.HtmlEditor.convertAlign=function(e){var t,r;try{r=parseInt(e)-1}catch(t){return e}switch(r){case 1:t="left";break;case 2:t="right";break;case 3:t="texttop";break;case 4:t="absmiddle";break;case 5:t="baseline";break;case 6:t="absbottom";break;case 7:t="bottom";break;case 8:t="middle";break;case 9:t="top";break;default:t=e.replace(/\"/g,"&quot;")}return t},Sys.Extended.UI.HtmlEditor.getHTML=function(e,t,r){try{if("undefined"==typeof r){if(!t&&1==e.nodeType)return e.innerHTML;if(t&&1==e.nodeType&&Sys.Extended.UI.HtmlEditor.isIE)return e.outerHTML}}catch(e){}var n=new Sys.Extended.UI.HtmlEditor.jsDocument((!0));return Sys.Extended.UI.HtmlEditor._getHTML_(n,e,t),n.toString()},Sys.Extended.UI.HtmlEditor._getHTML_=function(e,t,r,n){function i(e,t){U.push(t)}function d(){var e=U[b];return b++,e}function l(e,t,r,n){return t+r.replace(/(,)/g,"")+n}function o(e,t,r,n){return t+r.replace(/(['"])/g,"")+n}switch(t.nodeType){case 1:case 11:if(t.tagName&&t.tagName.indexOf("/")>=0){if(Sys.Extended.UI.HtmlEditor.isIE){var a=t.tagName.toLowerCase().substr(t.tagName.indexOf("/")+1),s=t.previousSibling;if("embed"==a)return;for(;null!=s;){if(s.nodeType==t.nodeType&&s.tagName&&s.tagName.toLowerCase()==a)return void e.append("</teo"+Sys.Extended.UI.HtmlEditor.smartClassName+":"+t.tagName.toLowerCase().substr(t.tagName.indexOf("/")+1)+">");s=s.previousSibling}}return}var m,E,f;if(r&&t.tagName.length>0){var a=t.tagName.toLowerCase();m=!(t.hasChildNodes()||Sys.Extended.UI.HtmlEditor._needsClosingTag(t)),E=!0;var p="";if(Sys.Extended.UI.HtmlEditor.isIE&&t.scopeName&&"undefined"!=typeof t.scopeName&&(p="HTML"==t.scopeName.toUpperCase()?"":t.scopeName+":"),Sys.Extended.UI.HtmlEditor.isIE&&(m||"placeholder"==a)&&!Sys.Extended.UI.HtmlEditor._noNeedsClosingTag(t)&&"embed"!=a)for(var c=t.nextSibling;null!=c;){if(c.nodeType==t.nodeType&&c.tagName){var g=c.tagName;if(g.indexOf("/")>=0&&g.toLowerCase().substr(g.indexOf("/")+1)==a){m=!1,E=!1;break}}c=c.nextSibling}Sys.Extended.UI.HtmlEditor.canBeInsideP(t)||e.append("\n"),e.append("<"+(m||E?p:"teo"+Sys.Extended.UI.HtmlEditor.smartClassName+":")+a),Sys.Extended.UI.HtmlEditor.isIE&&t.name&&t.name.length>0&&e.append(' name="'+t.name.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.value&&t.value.length>0&&"textarea"!=a&&e.append(' value="'+t.value.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.className&&t.className.length>0&&e.append(' class="'+t.className.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.align&&t.align.length>0&&e.append(' align="'+t.align.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.color&&t.color.length>0&&e.append(' color="'+t.color.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.size&&t.size.length>0&&"+0"!=t.size&&e.append(' size="'+t.size.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.shape&&t.shape.length>0&&e.write(' shape="'+t.shape.replace(/\"/g,"&quot;")+'"'),Sys.Extended.UI.HtmlEditor.isIE&&t.coords&&t.coords.length>0&&e.write(' coords="'+t.coords.replace(/\"/g,"&quot;")+'"');var u=t.attributes,y=null;for(f=0;f<u.length;++f){var h=u.item(f);if(h.specified){var S=h.name.toLowerCase();if("_moz"!=S.substr(0,4)&&"teoalign"!=S){var x;if("style"!=S){if("width"==S){if(x=t.width,Sys.Extended.UI.HtmlEditor.isIE&&0==x){var I=0;t.outerHTML.replace(new RegExp("^(?:<[^>]*?width=)([\\d]+)","ig"),function(e,t){I=t}),x!=I&&(x=I)}}else if("height"==S){if(x=t.height,Sys.Extended.UI.HtmlEditor.isIE&&0==x){var I=0;t.outerHTML.replace(new RegExp("^(?:<[^>]*?height=)([\\d]+)","ig"),function(e,t){I=t}),x!=I&&(x=I)}}else{if(Sys.Extended.UI.HtmlEditor.isIE&&"name"==S&&t.name&&t.name.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"value"==S&&t.value&&t.value.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"align"==S&&t.align&&t.align.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"class"==S&&t.className&&t.className.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"color"==S&&t.color&&t.color.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"size"==S&&t.size&&t.size.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"shape"==S&&t.shape&&t.shape.length>0)continue;if(Sys.Extended.UI.HtmlEditor.isIE&&"coords"==S&&t.coords&&t.coords.length>0)continue;if("embed"==a&&"align"==S&&Sys.Extended.UI.HtmlEditor.isIE)x=Sys.Extended.UI.HtmlEditor.convertAlign(h.value);else{if(x=h.value,Sys.Extended.UI.HtmlEditor.isSafari&&"class"==S&&/apple-style/gi.test(x))continue;"src"!=S&&"href"!=S||(Sys.Extended.UI.HtmlEditor.isIE&&(x=Sys.Extended.UI.HtmlEditor.getRealAttributeIE(t,S,x)),x=x.replace(/(\(S\([A-Za-z0-9_]+\)\)\/)/,"")),x=x.replace(/\"/g,"&quot;")}}var H='"';(""+x).indexOf('"')>=0&&(H="'"),null!=S&&e.append(" "+S+"="+H+x+H)}else Sys.Extended.UI.HtmlEditor.isSafari&&(y=h.value)}}}if(t.style.cssText.length>0||null!=y){var S="style",v=/(url\((?:[^\)]*)\))/gi,U=[],x=(null!=y?y:t.style.cssText).toLowerCase();x.replace(v,i);var b=0;if(x=Sys.Extended.UI.HtmlEditor.tryReplaceRgb(x.replace(v,d)).replace(/(font-weight\s*:\s*)(700)/gi,"$1bold").replace(/([\s]*-moz-[^;]*[;][\s]*)/gi,"").replace(/(-moz-.*)$/i,"").replace(/(background-position: 0% 0%[;]*[\s]*)/gi,""),Sys.Extended.UI.HtmlEditor.isSafari&&(x=x.replace(/(text-decoration:)([^;$]+)([;$])/gi,l)),(Sys.Extended.UI.HtmlEditor.isSafari||Sys.Extended.UI.HtmlEditor.isOpera)&&(x=x.replace(/(font-family:)([^;]+)([;]*)/gi,o)),x.length>0){var H='"';(""+x).indexOf('"')>=0&&(H="'"),e.append(" "+S+"="+H+x+H)}}e.append(m?" />":">"),"br"==a&&e.append("\n")}if(t.tagName&&"SCRIPT"==t.tagName.toUpperCase()&&e.append(t.text),t.tagName&&"STYLE"==t.tagName.toUpperCase())e.append(t.innerHTML);else for(f=t.firstChild;f;f=f.nextSibling)Sys.Extended.UI.HtmlEditor._getHTML_(e,f,!0);r&&t.tagName.length>0&&!m&&E&&e.append("</"+p+t.tagName.toLowerCase()+">");break;case 3:e.append(Sys.Extended.UI.HtmlEditor._encodeText_(""+t.data));break;case 8:t.length>0?e.append("<!--"+t.data+"-->"):e.append("<!---->")}},Sys.Extended.UI.HtmlEditor.RemoveContextMenu=function(){var e=this,t=e._contextElement.parentNode.removeChild(e._contextElement);t&&delete t,e._contextElement=null,e._contextTable=null,e.__saved_range__&&(e.__saved_range__.select(),e.__saved_range__=null)},Sys.Extended.UI.HtmlEditor.contentEditable=function(e,t){for(;null!=e;){try{var r=null;if(null==e.contentEditable||"undefined"==typeof e.contentEditable||Sys.Extended.UI.HtmlEditor.isSafari||Sys.Extended.UI.HtmlEditor.isOpera){var n=e.getAttribute("contenteditable");"boolean"==typeof n?r=n:"string"==typeof n&&"false"==n.toLowerCase()&&(r=!1)}else r=!(!e.contentEditable||"false"==e.contentEditable);if(null!=r&&"boolean"==typeof r&&!r)return e}catch(e){}if("undefined"!=typeof t&&t)return null;if(null!=e.tagName&&"undefined"!=typeof e.tagName&&("BODY"==e.tagName.toUpperCase()||"HTML"==e.tagName.toUpperCase()))break;e=e.parentNode}return null},Sys.Extended.UI.HtmlEditor.getSelParent=function(e){var t=e._getSelection(),r=e._createRange(t),n=null;if(Sys.Extended.UI.HtmlEditor.isIE)n="control"==t.type.toLowerCase()?r.item(0):e._getParent(r);else if(n=e._getParent(r),3!=n.nodeType&&r.startContainer==r.endContainer){var i=n;n=n.childNodes.item(r.startOffset),null==n&&(n=i)}return n},Sys.Extended.UI.HtmlEditor.__getIndex=function(e){var t=0;if(e.parentNode)for(;t<e.parentNode.childNodes.length&&e.parentNode.childNodes.item(t)!=e;t++);return t},Sys.Extended.UI.HtmlEditor.isInlineElement=function(e){if(3==e.nodeType)return!0;if(1!=e.nodeType)return!1;if(!e.tagName||0==e.tagName.length)return!1;if(e&&e.style&&e.style.display&&"inline"==e.style.display.toLowerCase())return!0;var t=e.tagName.toUpperCase();if(2==t.length&&"H"==t.substr(0,1)&&parseInt(t.substr(1,1))>0)return!1;switch(t){case"BR":case"TBODY":case"TR":case"TD":case"P":case"PRE":case"TABLE":case"OL":case"UL":case"LI":case"HR":case"DIV":case"BLOCKQUOTE":case"FORM":case"FIELDSET":case"LEGEND":return!1;default:return!0}},Sys.Extended.UI.HtmlEditor.capLock=function(e){var t=e.charCode,r=e.shiftKey?e.shiftKey:16==t;return!!(t>=65&&t<=90&&!r||t>=97&&t<=122&&r)},Sys.Extended.UI.HtmlEditor.operateAnchors=function(e,t,r){for(var n=t.getElementsByTagName("A"),i=!1,d=0;d<n.length;d++){var l=n[d];if(l.name&&l.name.length>0){for(var o=[],a=0;a<l.childNodes.length;a++){var s=l.childNodes.item(a);1==s.nodeType&&s.tagName&&"IMG"==s.tagName.toUpperCase()&&s.src==e._editPanel.get_imagePath_anchor()&&(o.push(s),i=!0)}for(;o.length>0;)l.removeChild(o.pop());if(!r){var m=t.createElement("IMG");m.title=l.name,m.src=e._editPanel.get_imagePath_anchor(),m.setAttribute(e.noContextMenuAttributeName(),"yes"),l.appendChild(m)}}}return i},Sys.Extended.UI.HtmlEditor.operatePlaceHolders=function(e,t,r){var n=!1;if(r){for(var i=t.getElementsByTagName("IMG"),d=[],l=0;l<i.length;l++)d.push(i[l]);for(var l=0;l<d.length;l++){var o=d[l],a=o.getAttribute("dummytag");if(a&&a.length>0&&"placeholder"==a.toLowerCase()){var s=t.createElement("PLACEHOLDER"),m=o.title;null!=m&&"undefined"!=typeof m||(m=o.getAttribute("title")),s.name=m,s.setAttribute("name",m),o.parentNode.insertBefore(s,o),o.parentNode.removeChild(o),n=!0}}}else{for(var i=t.getElementsByTagName("PLACEHOLDER"),d=[],l=0;l<i.length;l++)d.push(i[l]);for(var l=0;l<d.length;l++){var o=d[l],E=!0;try{o.childNodes.length>0&&(E=!1)}catch(e){}if(E){var f=o.name;null!=f&&"undefined"!=typeof f||(f=o.getAttribute("name"));var p=t.createElement("IMG");p.title=f,p.src=e._editPanel.get_imagePath_placeHolder(),p.setAttribute("dummytag","placeholder"),p.setAttribute("title",f),o.parentNode.insertBefore(p,o),o.parentNode.removeChild(o)}}}return n},Sys.Extended.UI.HtmlEditor.inspectForShadows=function(e){for(var t=e.getElementsByTagName("IMG"),r=0;r<t.length;r++)if(t[r].getAttribute(Sys.Extended.UI.HtmlEditor.attachedIdAttribute)&&t[r].getAttribute(Sys.Extended.UI.HtmlEditor.attachedIdAttribute).length>0){try{Sys.Extended.UI.HtmlEditor.isIE?$removeHandler(t[r],"dragstart",Sys.Extended.UI.HtmlEditor.stopDrag):$removeHandler(t[r],"draggesture",Sys.Extended.UI.HtmlEditor.stopDrag)}catch(e){}Sys.Extended.UI.HtmlEditor.isIE?$addHandler(t[r],"dragstart",Sys.Extended.UI.HtmlEditor.stopDrag):$addHandler(t[r],"draggesture",Sys.Extended.UI.HtmlEditor.stopDrag)}},Sys.Extended.UI.HtmlEditor.attachedIdAttribute="obout-attached-id",Sys.Extended.UI.HtmlEditor.stopDrag=function(e){return e&&e.stopPropagation(),e.preventDefault(),!1},Sys.Extended.UI.HtmlEditor.replacingRules=[["strong","font-weight","bold"],["b","font-weight","bold"],["strong","font-weight","700"],["em","font-style","italic"],["i","font-style","italic"],["u","text-decoration","underline"],["strike","text-decoration","line-through"]],Sys.Extended.UI.HtmlEditor.replaceOldTags=function(e,t){for(var r=e.innerHTML,n=!1,i=0;i<Sys.Extended.UI.HtmlEditor.replacingRules.length;i++){var d=new RegExp("<"+Sys.Extended.UI.HtmlEditor.replacingRules[i][0]+"[s>]","ig");if(d.test(r)){n=!0;break}}if(n||/<font[\s>]/gi.test(r))for(var l=0;l<e.childNodes.length;l++){var o=e.childNodes.item(l);if(1==o.nodeType){for(var a=null,s=o.tagName.toLowerCase(),i=0;i<Sys.Extended.UI.HtmlEditor.replacingRules.length;i++)if(Sys.Extended.UI.HtmlEditor.replacingRules[i][0].toLowerCase()==s){a=Sys.Extended.UI.HtmlEditor.replacingRules[i];break}if(a){var m=t._doc.createElement("SPAN");for(m.style.cssText=o.style.cssText,Sys.Extended.UI.HtmlEditor.isIE?m.style[a[1]]=a[2]:m.style[a[1].replace(/\-(\w)/g,function(e,t){return t.toUpperCase()})]=a[2];o.firstChild;)m.appendChild(o.firstChild);e.insertBefore(m,o),e.removeChild(o),o=m}else if("font"==s){var m=t._doc.createElement("SPAN"),E=o.size;for(m.style.cssText=o.style.cssText,o.color&&(m.style.color=o.color),o.face&&(m.style.fontFamily=o.face);o.firstChild;)m.appendChild(o.firstChild);if(e.insertBefore(m,o),e.removeChild(o),E){var f=t._doc.createElement("FONT");if(f.size=E,e.insertBefore(f,m),m.style.cssText.length>0)f.appendChild(m),o=m;else{for(;m.firstChild;)f.appendChild(m.firstChild);e.removeChild(m),o=f}}else o=m}Sys.Extended.UI.HtmlEditor.replaceOldTags(o,t)}}},Sys.Extended.UI.HtmlEditor.getStyle=function(e,t){var r="";if(1==e.nodeType)if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)r=e.ownerDocument.defaultView.getComputedStyle(e,"").getPropertyValue(t);else if(e.currentStyle)try{t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),r=e.currentStyle[t]}catch(n){r=e.style[t]}else r=e.style[t];return r},Sys.Extended.UI.HtmlEditor._Marker=function(e,t,r){if(Sys.Extended.UI.HtmlEditor.isIE)if(this._nArr=Sys.Extended.UI.HtmlEditor.getNames(e._doc.body),this._save=e._doc.body.innerHTML,this._tree=null,"control"==r.type.toLowerCase())try{var n=t.item(0);for(this._tree=[];n&&(3==n.nodeType||!n.tagName||"BODY"!=n.tagName.toUpperCase());){for(var i=0;n.previousSibling;)i++,n=n.previousSibling;this._tree.push(i),n=n.parentNode}}catch(e){}else this._offsetLeft=t.offsetLeft,this._offsetTop=t.offsetTop;else{Sys.Extended.UI.HtmlEditor.isOpera?this._save=Sys.Extended.UI.HtmlEditor.Trim(e._doc.body.innerHTML):this._save=e._doc.body.cloneNode(!0),this._tree=[],this._offset=0;try{var n=t.startContainer;for(this._offset=t.startOffset,n&&1==n.nodeType&&"HTML"==n.tagName.toUpperCase()&&(n=e._doc.body,setTimeout(function(){try{r=e._getSelection(),t=e._createRange(),e._removeAllRanges(r),t.setStart(n,0),t.setEnd(n,0),e._selectRange(r,t)}catch(e){}},0));n&&n.nodeType&&(3==n.nodeType||!n.tagName||"BODY"!=n.tagName.toUpperCase());){for(var i=0;n.previousSibling;)i++,Sys.Extended.UI.HtmlEditor.isOpera&&3==n.nodeType&&null!=n.previousSibling&&3==n.previousSibling.nodeType&&i--,n=n.previousSibling;this._tree.push(i),n=n.parentNode}}catch(e){}}},Sys.Extended.UI.HtmlEditor.__stackMaxSize=30,Sys.Extended.UI.HtmlEditor.getNames=function(e){for(var t=e.all,r=[],n=[],i=0;i<t.length;i++){var d=t[i];if(d.name&&d.name.length>0){for(var l=d.tagName,o=e.getElementsByTagName(l),a=0,s=0;s<o.length;s++)if(o[s]==d){a=s;break}n[l]=a,r.push([l,n[l],d.name])}}return r},Sys.Extended.UI.HtmlEditor.setNames=function(e,t){for(var r=0;r<t.length;r++)e.getElementsByTagName(t[r][0]).length>t[r][1]&&(e.getElementsByTagName(t[r][0])[t[r][1]].name=t[r][2])},Sys.Extended.UI.HtmlEditor._lookChild=function(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes.item(r);if(n==t)return r;if(1==n.nodeType&&Sys.Extended.UI.HtmlEditor._lookChild(n,t)>=0)return r}return-1},Sys.Extended.UI.HtmlEditor.getHrefsText=function(e){function t(e,t,n,i,d,l,o,a){for(var s=t.replace(/^<([^\s>]+)/,"$1"),m=!0,E=0;E<r.length;E++)if(r[E][0]==s){m=!1;break}m&&(r[E]=[s]),r[E].push(l)}var r=[],n=new RegExp("(<[^\\s><]+)([^><]*?)(href=)(\"|')([^\\4]*?)(\\4)((?:[^><]*?)>)","ig");return e.replace(n,t),r},Sys.Extended.UI.HtmlEditor.setHrefsText=function(e,t){for(var r=0;r<t.length;r++)for(var n=e.getElementsByTagName(t[r][0]),i=1,d=0;d<n.length;d++)if(n[d].href){if(t[r][i]&&t[r][i].length>0){var l;Sys.Extended.UI.HtmlEditor.isIE&&(l=n[d].innerHTML),n[d].href=t[r][i].replace(/&amp;/gi,"&"),Sys.Extended.UI.HtmlEditor.isIE&&(n[d].innerHTML=l)}i++}},Sys.Extended.UI.HtmlEditor.getImagesText=function(e){function t(e,t,n,i,d,l){return r.push(i),e}var r=[];return e.replace(/(<img(?:.*?))(src=")(.*?)(")((?:.*?)>)/gi,t),r},Sys.Extended.UI.HtmlEditor.setImagesText=function(e,t){for(var r=e.getElementsByTagName("IMG"),n=0,i=0;i<r.length;i++)r[i].src&&(t[n]&&t[n].length>0&&(r[i].src=t[n].replace(/&amp;/gi,"&")),n++)},Sys.Extended.UI.HtmlEditor.canHaveChildren=function(e){return Sys.Extended.UI.HtmlEditor.isIE?e.canHaveChildren:!/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(e.tagName.toLowerCase())},Sys.Extended.UI.HtmlEditor._setCursor=function(e,t){var r=e;if(Sys.Extended.UI.HtmlEditor.isIE){var n=t._getSelection(),i=t._createRange(n);"control"==n.type.toLowerCase()&&(i.remove(0),n.empty(),i=t._createRange());var d,l=3==r.nodeType;l&&(d=t._doc.createElement("SPAN"),d.innerHTML="&nbsp;",r.parentNode.insertBefore(d,r),r=d);var o=$common.getLocation(r),a=o.x,s=o.y;l&&d.parentNode.removeChild(d);try{i.moveToPoint(a,s)}catch(e){}i.select()}else{var n=t._getSelection(),i=t._createRange();i.setStart(r,0),i.setEnd(r,0),t._removeAllRanges(n),
t._selectRange(n,i),t.focusEditor()}},Sys.Extended.UI.HtmlEditor.myClone=function(e,t,r){var n;if(Sys.Extended.UI.HtmlEditor.isIE&&e.tagName&&("EMBED"==e.tagName.toUpperCase()||"OBJECT"==e.tagName.toUpperCase())){var i=t.createElement("DIV");try{i.innerHTML=e.outerHTML,n=i.firstChild}catch(t){n=e}delete i}else n=e.cloneNode(r);return n},Sys.Extended.UI.HtmlEditor.unStyle=function(e){function t(e,r,i,d,l){var o=i.cloneNode(!1);if(e)if(e.push&&"function"==typeof e.push)for(var a=0;a<e.length;a++)o.appendChild(e[a]);else o.appendChild(e);if(l)o.appendChild(r);else for(;r;){var s=d?r.previousSibling:r.nextSibling;(1==r.nodeType||3==r.nodeType&&Sys.Extended.UI.HtmlEditor.Trim(""+r.data).length>0)&&(1==r.nodeType&&r.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(r.tagName)&&0==r.childNodes.length&&!Sys.Extended.UI.HtmlEditor.isTempElement(r)&&(r=null),r&&(0!=o.childNodes.length&&d?o.insertBefore(r,o.firstChild):o.appendChild(r))),r=s}if(0==o.childNodes.length)delete o,o=null;else if(1==o.childNodes.length&&3==o.firstChild.nodeType&&0==(""+o.firstChild.data).length)delete o,o=null;else if(!l&&o.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(o.tagName)&&"A"!=o.tagName.toUpperCase()&&!Sys.Extended.UI.HtmlEditor.isTempElement(o)){for(var m=o.childNodes.length,E=0;E<o.childNodes.length;E++){var f=o.childNodes.item(E);1!=f.nodeType||!f.tagName||Sys.Extended.UI.HtmlEditor.isStyleTag(f.tagName)||"BR"!=f.tagName.toUpperCase()&&"TABLE"!=f.tagName.toUpperCase()&&!Sys.Extended.UI.HtmlEditor.isTempElement(f)||m--}if(0==m){for(var p=[];o.firstChild;){var f=o.removeChild(o.firstChild);p.push(f)}o=p}}return i==n?o:l?t(null,o,i.parentNode,d,l):t(o,d?i.previousSibling:i.nextSibling,i.parentNode,d,l)}var r=null!=e.parentNode&&"undefined"!=typeof e.parentNode?e.parentNode:null;if(r){for(var n=null;r&&r.tagName&&"BODY"!=r.tagName.toUpperCase()&&Sys.Extended.UI.HtmlEditor.isStyleTag(r.tagName)&&"A"!=r.tagName.toUpperCase();)n=r,r=r.parentNode;if(n){r=e.parentNode,null==e.previousSibling&&null==e.nextSibling&&r&&r.tagName&&"BODY"!=r.tagName.toUpperCase()&&Sys.Extended.UI.HtmlEditor.isStyleTag(r.tagName)&&Sys.Extended.UI.HtmlEditor.differAttr(r,["class","color","face","size"]).length>0&&(e=r);var i=t(null,e.previousSibling,e.parentNode,!0,!1),d=t(null,e.nextSibling,e.parentNode,!1,!1),l=n.parentNode;if(i)if(i.push&&"function"==typeof i.push)for(var o=0;o<i.length;o++)l.insertBefore(i[o],n);else l.insertBefore(i,n);if(1==e.nodeType&&e.tagName&&("BR"==e.tagName.toUpperCase()||"TABLE"==e.tagName.toUpperCase()||Sys.Extended.UI.HtmlEditor.isTempElement(e)))l.insertBefore(e,n);else{var a=t(null,e,e.parentNode,!1,!0);l.insertBefore(a,n)}if(d)if(d.push&&"function"==typeof d.push)for(var o=0;o<d.length;o++)l.insertBefore(d[o],n);else l.insertBefore(d,n);l.removeChild(n)}}},Sys.Extended.UI.HtmlEditor.isTempElement=function(e){return!!(e.id&&e.id.length>0&&e.id.indexOf(Sys.Extended.UI.HtmlEditor.smartClassName)>=0)},Sys.Extended.UI.HtmlEditor._moveTagsUp=function(e,t){function r(e){if(Sys.Extended.UI.HtmlEditor.isInlineElement(e)&&3!=e.nodeType){if(e.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(e.tagName)&&"A"!=e.tagName.toUpperCase()&&!Sys.Extended.UI.HtmlEditor.isTempElement(e))for(var t=e.firstChild;null!=t;){var n=t.nextSibling;r(t),t=n}}else Sys.Extended.UI.HtmlEditor.unStyle(e)}for(var n=e;null!=n&&n!=t;){var i=n.nextSibling;r(n),n=i}},Sys.Extended.UI.HtmlEditor._commonTotalParent=function(e,t){for(var r=null,n=e.parentNode,i=e;n;){if(n.tagName&&!Sys.Extended.UI.HtmlEditor.isStyleTag(n.tagName)){var d=Sys.Extended.UI.HtmlEditor._lookChild(n,t);if(d>=0){for(var l=0,o=0;o<n.childNodes.length;o++)if(n.childNodes.item(o)==i){l=o;break}return{parent:n,indexFirst:l,indexLast:d}}}i=n,n=n.parentNode}return r},Sys.Extended.UI.HtmlEditor._commonParent=function(e,t){for(var r=null,n=e.parentNode,i=e;n&&"BODY"!=n.tagName.toUpperCase()&&Sys.Extended.UI.HtmlEditor.isStyleTag(n.tagName);){var d=Sys.Extended.UI.HtmlEditor._lookChild(n,t);if(d>=0){for(var l=0,o=0;o<n.childNodes.length;o++)if(n.childNodes.item(o)==i){l=o;break}return{parent:n,indexFirst:l,indexLast:d}}i=n,n=n.parentNode}return r},Sys.Extended.UI.HtmlEditor.positionInParagraph=function(e,t,r,n,i){for(;;){var d=Sys.Extended.UI.HtmlEditor.positionInParagraphLevel(e,t,r,i);if(null!=d)return d;if(!n.tagName||!Sys.Extended.UI.HtmlEditor.isStyleTag(n.tagName)||"A"==n.tagName.toUpperCase()||Sys.Extended.UI.HtmlEditor.isTempElement(n))return r&&null!=n.firstChild?n.insertBefore(e,n.firstChild):n.appendChild(e),e;t=r?n.previousSibling:n.nextSibling,n=n.parentNode}},Sys.Extended.UI.HtmlEditor.positionInParagraphLevel=function(e,t,r,n){for(;t;){var i=r?t.previousSibling:t.nextSibling;if(!Sys.Extended.UI.HtmlEditor.isInlineElement(t)){var d=t.parentNode;return r?t.nextSibling?d.insertBefore(e,t.nextSibling):d.appendChild(e):d.insertBefore(e,t),e}if("function"==typeof n&&3==t.nodeType){var l,o=""+t.data;if(r)for(l=o.length-1;l>=0&&!n(o.substr(l,1));l--);else for(l=0;l<o.length&&!n(o.substr(l,1));l++);if(l>=0&&l<o.length){var a,d=t.parentNode;return(l>0||r&&0==l)&&(l<o.length-1||!r&&l==o.length-1)?(a=r?t.splitText(l+1):t.splitText(l),d.insertBefore(e,a)):r?t.nextSibling?d.insertBefore(e,t.nextSibling):d.appendChild(e):d.insertBefore(e,t),e}}if(t=r?t.lastChild:t.firstChild){var s=Sys.Extended.UI.HtmlEditor.positionInParagraphLevel(e,t,r,n);if(null!=s)return s}t=i}return null},Sys.Extended.UI.HtmlEditor._addEvent=function(e,t,r){e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener&&e.addEventListener(t,r,!0)},Sys.Extended.UI.HtmlEditor._addEvents=function(e,t,r){for(var n=0;n<t.length;n++)Sys.Extended.UI.HtmlEditor._addEvent(e,t[n],r)},Sys.Extended.UI.HtmlEditor._removeEvent=function(e,t,r){e.detachEvent?e.detachEvent("on"+t,r):e.removeEventListener&&e.removeEventListener(t,r,!0)},Sys.Extended.UI.HtmlEditor._removeEvents=function(e,t,r){for(var n=0;n<t.length;n++)Sys.Extended.UI.HtmlEditor._removeEvent(e,t[n],r)},Sys.Extended.UI.HtmlEditor._stopEvent=function(e){e&&(Sys.Extended.UI.HtmlEditor.isIE?(e.cancelBubble=!0,e.returnValue=!1):(e.preventDefault(),e.stopPropagation()))},Sys.Extended.UI.HtmlEditor.restrictedTags=["DIV","P","TD","TR","TABLE","TBODY","LI","OL","UL","FORM","INPUT"],Sys.Extended.UI.HtmlEditor.isRestricted=function(e){for(var t=e.tagName.toUpperCase(),r=0;r<Sys.Extended.UI.HtmlEditor.restrictedTags.length;r++)if(Sys.Extended.UI.HtmlEditor.restrictedTags[r].toUpperCase()==t)return!0;return!(!Sys.Extended.UI.HtmlEditor.isIE||"HTML"==e.scopeName.toUpperCase())},Sys.Extended.UI.HtmlEditor.jsDocument=function(e){this.noExtraLf="undefined"!=typeof e&&e,this.text=[],this.write=function(e){(!this.noExtraLf||0==this.text.length&&"\n"!=e||this.text.length>0&&("\n"!=this.text[this.text.length-1]||"\n"!=e))&&(this.text[this.text.length]=e)},this.append=this.write,this.writeln=function(e){this.text[this.text.length]=e+"\n"},this.toString=function(){return this.text.join("")},this.clear=function(){delete this.text,this.text=null,this.text=new Array}},Sys.Extended.UI.HtmlEditor.isHeader=function(e){var t=e.tagName.toUpperCase();return 2==t.length&&"H"==t.substr(0,1)&&parseInt(t.substr(1,1))>0},Sys.Extended.UI.HtmlEditor._getReallyFirst=function(e){return"undefined"!=typeof e.firstChild&&null!=e.firstChild&&"undefined"!=typeof e.firstChild.childNodes&&null!=e.firstChild.childNodes?Sys.Extended.UI.HtmlEditor._getReallyFirst(e.firstChild):e},Sys.Extended.UI.HtmlEditor._getReallyLast=function(e){return"undefined"!=typeof e.lastChild&&null!=e.lastChild&&"undefined"!=typeof e.lastChild.childNodes&&null!=e.lastChild.childNodes?Sys.Extended.UI.HtmlEditor._getReallyLast(e.lastChild):e},Sys.Extended.UI.HtmlEditor._reallyFirst=function(e,t){if(e.firstChild){if(e.firstChild==t)return!0;if(e.firstChild.childNodes&&0==Sys.Extended.UI.HtmlEditor._lookChild(e.firstChild,t))return Sys.Extended.UI.HtmlEditor._reallyFirst(e.firstChild,t)}return!1},Sys.Extended.UI.HtmlEditor._reallyLast=function(e,t){if(e.lastChild){if(e.lastChild==t)return!0;if(e.lastChild.childNodes&&Sys.Extended.UI.HtmlEditor._lookChild(e.lastChild,t)==e.lastChild.childNodes.length-1)return Sys.Extended.UI.HtmlEditor._reallyLast(e.lastChild,t)}return!1},Sys.Extended.UI.HtmlEditor.getContainer=function(e,t){if(t==e)return e;if(1==e.nodeType)for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes.item(r);if(t==n)return n;if(1==n.nodeType){var i=Sys.Extended.UI.HtmlEditor._lookChild(n,t);if(i>=0)return n.tagName&&Sys.Extended.UI.HtmlEditor.isStyleTag(n.tagName)&&"A"!=n.tagName.toUpperCase()&&!Sys.Extended.UI.HtmlEditor.isTempElement(n)?Sys.Extended.UI.HtmlEditor.getContainer(n,t):n}}return null},Sys.Extended.UI.HtmlEditor._TryTransformFromPxToPt=function(e,t,r){var n=e.replace(/^(\d+)\.(\d+)px/i,"$1px");if(!Sys.Extended.UI.HtmlEditor.isIE&&n&&n.length>0){var i=n.toLowerCase().split(",")[0];if("undefined"!=typeof r){var d=document.getElementById(r);if(null!=d){var l;for(l=0;l<d.options.length;l++){var o=Sys.Extended.UI.HtmlEditor.fontSizeSeek(d.options.item(l).value.toLowerCase().split(",")[0]);if(o==i)break}if(l==d.options.length){var a=t._doc.createElement("SPAN");for(t._doc.body.appendChild(a),l=1;l<100;l++)if(a.style.fontSize=l+"pt",Sys.Extended.UI.HtmlEditor.getStyle(a,"font-size").replace(/^(\d+)\.(\d+)px/i,"$1px")==i){i=l+"pt";break}a.parentNode.removeChild(a)}}}n=i}return n},Sys.Extended.UI.HtmlEditor.fontSizeSeek=function(e){var t=e.toString();switch(t){case"1":t="8pt";break;case"2":t="10pt";break;case"3":t="12pt";break;case"4":t="14pt";break;case"5":t="18pt";break;case"6":t="24pt";break;case"7":t="36pt"}return t},Sys.Extended.UI.HtmlEditor.getOwnerDocument=function(e){return 9==e.nodeType?e:e.ownerDocument||e.document},Sys.Extended.UI.HtmlEditor.getClientViewportElement=function(e){var t;return t=9==e.nodeType?e:Sys.Extended.UI.HtmlEditor.getOwnerDocument(e),Sys.Extended.UI.HtmlEditor.isIE&&"CSS1Compat"!=t.compatMode?t.body:t.documentElement},Sys.Extended.UI.HtmlEditor.isReallyVisible=function(e){for(var t=e,r=!0;t;){if(t.style&&"none"==Sys.Extended.UI.HtmlEditor.getStyle(t,"display")){r=!1;break}t=t.parentNode}return r},Sys.Extended.UI.HtmlEditor.setSelectionRange=function(e,t,r){if(e.focus(),e.setSelectionRange)e.setSelectionRange(t,r);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n.select()}},Sys.Extended.UI.HtmlEditor.setElementVisibility=function(e){for(var t=new Array,r=e;r&&1==r.nodeType&&"BODY"!=r.tagName.toUpperCase();){var n=r.style.display,i=r.style.visibility;!r.style||"none"!=n&&"hidden"!=i||(t.push({element:r,display:n,visibility:i}),r.style.display="",r.style.visibility="visible"),r=r.parentNode}return t},Sys.Extended.UI.HtmlEditor.restoreElementVisibility=function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.element.style;n.display=r.display,n.visibility=r.visibility}},!Sys.Extended.UI.HtmlEditor.isIE)try{Sys.Extended.UI.HtmlEditor.__MozillaGetInnerText=function(e,t){for(var r=e.childNodes,n=0;n<r.length;n++){var i=r[n];if(3==i.nodeType&&t.write(i.nodeValue.replace("\n","")),1==i.nodeType){var d=Sys.Extended.UI.HtmlEditor.getStyle(i,"display"),l=Sys.Extended.UI.HtmlEditor.getStyle(i,"visibility");Sys.Extended.UI.HtmlEditor.__needLineBreakBefore(i)&&t.write("\n"),Sys.Extended.UI.HtmlEditor.__needTabBefore(i)&&t.write("\t"),"none"!=d&&"hidden"!=l&&Sys.Extended.UI.HtmlEditor.__MozillaGetInnerText(i,t),Sys.Extended.UI.HtmlEditor.__needLineBreakAfter(i)&&t.write("\n")}}},Sys.Extended.UI.HtmlEditor.__needLineBreakBefore=function(e){var t=" div table p pre ol ul blockquote form fieldset ";return t.indexOf(" "+e.tagName.toLowerCase()+" ")!=-1},Sys.Extended.UI.HtmlEditor.__needLineBreakAfter=function(e){var t=" br div table tr p pre ol ul li hr blockquote form fieldset legend ";return t.indexOf(" "+e.tagName.toLowerCase()+" ")!=-1},Sys.Extended.UI.HtmlEditor.__needTabBefore=function(e){var t=" td li ";return t.indexOf(" "+e.tagName.toLowerCase()+" ")!=-1}}catch(e){}